!function(e){function t(t){for(var n,r,a=t[0],c=t[1],l=t[2],d=0,p=[];d<a.length;d++)r=a[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&p.push(i[r][0]),i[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(u&&u(t);p.length;)p.shift()();return s.push.apply(s,l||[]),o()}function o(){for(var e,t=0;t<s.length;t++){for(var o=s[t],n=!0,a=1;a<o.length;a++){var c=o[a];0!==i[c]&&(n=!1)}n&&(s.splice(t--,1),e=r(r.s=o[0]))}return e}var n={},i={2:0},s=[];function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=n,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var a=window.webpackJsonp=window.webpackJsonp||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=c;s.push([20,0]),o()}([,,,,,,,,,,function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.downvoteButtonColor=t.SkipNoticeAction=void 0;const n=o(0);!function(e){e[e.None=0]="None",e[e.Upvote=1]="Upvote",e[e.Downvote=2]="Downvote",e[e.CategoryVote=3]="CategoryVote",e[e.CopyDownvote=4]="CopyDownvote",e[e.Unskip=5]="Unskip"}(t.SkipNoticeAction||(t.SkipNoticeAction={})),t.downvoteButtonColor=function(e,t,o){return(null==e?void 0:e.length)>1?t===o?n.default.config.colorPalette.red:n.default.config.colorPalette.white:n.default.config.isVip&&1===(null==e?void 0:e[0].locked)?n.default.config.colorPalette.locked:n.default.config.colorPalette.white}},,,,function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(1),i=o(0);var s;!function(e){e[e.Timer=0]="Timer",e[e.Paused=1]="Paused",e[e.Stopped=2]="Stopped"}(s||(s={}));class r extends n.Component{constructor(e){var t;super(e);const o=()=>this.props.maxCountdownTime?this.props.maxCountdownTime():i.default.config.skipNoticeDuration;this.countdownInterval=null,this.amountOfPreviousNotices=e.amountOfPreviousNotices||0,this.idSuffix=e.idSuffix||"",this.state={noticeTitle:e.noticeTitle,maxCountdownTime:o,countdownTime:o(),countdownMode:s.Timer,mouseHovering:!1,startFaded:null!==(t=this.props.startFaded)&&void 0!==t&&t}}componentDidMount(){this.startCountdown()}render(){var e;const t=Object.assign({zIndex:this.props.zIndex||1e3+this.amountOfPreviousNotices},null!==(e=this.props.style)&&void 0!==e?e:{});return n.createElement("div",{id:"sponsorSkipNotice"+this.idSuffix,className:"sponsorSkipObject sponsorSkipNoticeParent"+(this.props.showInSecondSlot?" secondSkipNotice":""),onMouseEnter:e=>this.onMouseEnter(e),onMouseLeave:()=>this.timerMouseLeave(),style:t},n.createElement("div",{className:"sponsorSkipNoticeTableContainer"+(this.props.fadeIn?" sponsorSkipNoticeFadeIn":"")+(this.state.startFaded?" sponsorSkipNoticeFaded":"")},n.createElement("table",{className:"sponsorSkipObject sponsorSkipNotice"+(this.props.limitWidth?" sponsorSkipNoticeLimitWidth":"")},n.createElement("tbody",null,n.createElement("tr",{id:"sponsorSkipNoticeFirstRow"+this.idSuffix,className:"sponsorSkipNoticeFirstRow"},n.createElement("td",{className:"noticeLeftIcon"},n.createElement("img",{id:"sponsorSkipLogo"+this.idSuffix,className:"sponsorSkipLogo sponsorSkipObject",src:chrome.extension.getURL("icons/IconSponsorBlocker256px.png")}),n.createElement("span",{id:"sponsorSkipMessage"+this.idSuffix,style:{float:"left"},className:"sponsorSkipMessage sponsorSkipObject"},this.state.noticeTitle),this.props.firstColumn),this.props.firstRow,n.createElement("td",{className:"sponsorSkipNoticeRightSection",style:{top:"9.32px"}},this.props.timed?n.createElement("span",{id:"sponsorSkipNoticeTimeLeft"+this.idSuffix,onClick:()=>this.toggleManualPause(),className:"sponsorSkipObject sponsorSkipNoticeTimeLeft"},this.getCountdownElements()):"",n.createElement("img",{src:chrome.extension.getURL("icons/close.png"),className:"sponsorSkipObject sponsorSkipNoticeButton sponsorSkipNoticeCloseButton sponsorSkipNoticeRightButton"+(this.props.biggerCloseButton?" biggerCloseButton":""),onClick:()=>this.close()}))),this.props.children,!this.props.smaller&&this.props.bottomRow?this.props.bottomRow:null))),this.props.smaller&&this.props.bottomRow?n.createElement("table",{style:{visibility:"hidden",paddingTop:"14px"}},n.createElement("tbody",null,this.props.bottomRow)):null)}getCountdownElements(){return[n.createElement("span",{id:"skipNoticeTimerText"+this.idSuffix,key:"skipNoticeTimerText",className:this.state.countdownMode!==s.Timer?"hidden":""},this.state.countdownTime+"s"),n.createElement("img",{id:"skipNoticeTimerPaused"+this.idSuffix,key:"skipNoticeTimerPaused",className:this.state.countdownMode!==s.Paused?"hidden":"",src:chrome.runtime.getURL("icons/pause.svg"),alt:chrome.i18n.getMessage("paused")}),n.createElement("img",{id:"skipNoticeTimerStopped"+this.idSuffix,key:"skipNoticeTimerStopped",className:this.state.countdownMode!==s.Stopped?"hidden":"",src:chrome.runtime.getURL("icons/stop.svg"),alt:chrome.i18n.getMessage("manualPaused")})]}onMouseEnter(e){this.props.onMouseEnter&&this.props.onMouseEnter(e),this.fadedMouseEnter(),this.timerMouseEnter()}fadedMouseEnter(){this.state.startFaded&&this.setState({startFaded:!1})}timerMouseEnter(){this.state.countdownMode!==s.Stopped&&(this.pauseCountdown(),this.setState({mouseHovering:!0}))}timerMouseLeave(){this.state.countdownMode!==s.Stopped&&(this.startCountdown(),this.setState({mouseHovering:!1}))}toggleManualPause(){this.setState({countdownMode:this.state.countdownMode===s.Stopped?s.Timer:s.Stopped},()=>{this.state.countdownMode===s.Stopped||this.state.mouseHovering?this.pauseCountdown():this.startCountdown()})}countdown(){if(!this.props.timed)return;const e=Math.min(this.state.countdownTime-1,this.state.maxCountdownTime());if(e<=0)return clearInterval(this.countdownInterval),void this.close();if(3==e){const e=document.getElementById("sponsorSkipNotice"+this.idSuffix);null==e||e.style.removeProperty("animation"),null==e||e.classList.add("sponsorSkipNoticeFadeOut")}this.setState({countdownTime:e})}removeFadeAnimation(){const e=document.getElementById("sponsorSkipNotice"+this.idSuffix);e.classList.remove("sponsorSkipNoticeFadeOut"),e.style.animation="none"}pauseCountdown(){this.props.timed&&(this.countdownInterval&&clearInterval(this.countdownInterval),this.countdownInterval=null,this.setState({countdownTime:this.state.maxCountdownTime(),countdownMode:this.state.countdownMode===s.Timer?s.Paused:this.state.countdownMode}),this.removeFadeAnimation())}startCountdown(){this.props.timed&&null===this.countdownInterval&&(this.setState({countdownTime:this.state.maxCountdownTime(),countdownMode:s.Timer}),this.setupInterval())}setupInterval(){this.countdownInterval&&clearInterval(this.countdownInterval),this.countdownInterval=setInterval(this.countdown.bind(this),1e3)}resetCountdown(){this.props.timed&&(this.setupInterval(),this.setState({countdownTime:this.state.maxCountdownTime(),countdownMode:s.Timer}),this.removeFadeAnimation())}close(e){null!==this.countdownInterval&&clearInterval(this.countdownInterval),e||this.props.closeListener()}changeNoticeTitle(e){this.setState({noticeTitle:e})}addNoticeInfoMessage(e,t=""){const o=document.getElementById("sponsorTimesInfoMessage"+this.idSuffix);null!=o&&document.getElementById("sponsorSkipNotice"+this.idSuffix).removeChild(o);const n=document.getElementById("sponsorTimesInfoMessage"+this.idSuffix+"2");null!=n&&document.getElementById("sponsorSkipNotice"+this.idSuffix).removeChild(n);const i=document.createElement("p");if(i.id="sponsorTimesInfoMessage"+this.idSuffix,i.className="sponsorTimesInfoMessage",i.innerText=e,document.querySelector("#sponsorSkipNotice"+this.idSuffix+" > tbody").insertBefore(i,document.getElementById("sponsorSkipNoticeSpacer"+this.idSuffix)),void 0!==t){const e=document.createElement("p");e.id="sponsorTimesInfoMessage"+this.idSuffix+"2",e.className="sponsorTimesInfoMessage",e.innerText=t,document.querySelector("#sponsorSkipNotice"+this.idSuffix+" > tbody").insertBefore(e,document.getElementById("sponsorSkipNoticeSpacer"+this.idSuffix))}}}t.default=r},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(1);class i extends n.Component{constructor(e){super(e)}render(){const e={};return this.props.onClick&&(e.cursor="pointer",e.textDecoration="underline"),n.createElement("p",{id:"sponsorTimesInfoMessage"+this.props.idSuffix,onClick:this.props.onClick,style:e,className:"sponsorTimesInfoMessage"},this.props.text)}}t.default=i},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(1);t.default=({fill:e="#ffffff"})=>n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",fill:e,viewBox:"0 0 24 24"},n.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),n.createElement("path",{d:"M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z"}))},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(1);t.default=({fill:e="#ffffff"})=>n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",fill:e,viewBox:"0 0 24 24"},n.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),n.createElement("path",{d:"M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm4 0v12h4V3h-4z"}))},,,function(e,t,o){"use strict";var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=o(0),s=o(4),r=new(o(2).default),a=o(18),c=o(21),l=o(22),u=o(29),d=o(33),p=o(5),h=o(34),m=o(35),g=o(12),f=o(36),y=o(8),v=o(7);r.wait(()=>null!==i.default.config,5e3,10).then((function(){!r.isFirefox()&&i.default.config.invidiousInstances.includes(new URL(document.URL).host)&&window.addEventListener("DOMContentLoaded",()=>{const e=document.getElementsByTagName("head")[0];for(const t of r.css){const o=document.createElement("link");o.rel="stylesheet",o.type="text/css",o.href=chrome.extension.getURL(t),e.appendChild(o)}})}));let S=!1,T=null,k=null;const C=[];let b,w,x=null,E=null,N=[],M=null,I=[],A=!1,B=null;const L=[],O=[];let U,P,D,R=null,V=!1,F=0,_=-1,j=!1,H=null,W=null,q=null,K=null;const Y={};r.wait(()=>null!==i.default.config,1e3,1).then(()=>te(me(document))),document.addEventListener("yt-navigate-finish",()=>{g.isVisible(w)||le()}),document.addEventListener("keydown",Ye);let z=0,G=[],$=!1,J=null,X=!1;const Q=()=>({vote:Fe,dontShowNoticeAgain:je,unskipSponsorTime:be,sponsorTimes:T,sponsorTimesSubmitting:G,skipNotices:C,v:w,sponsorVideoID:k,reskipSponsorTime:we,updatePreviewBar:ye,onMobileYouTube:P,sponsorSubmissionNotice:J,resetSponsorSubmissionNotice:He,updateEditButtonsOnPlayer:Ae,previewTime:Te,videoInfo:E,getRealCurrentTime:Be,lockedCategories:N});function Z(e,t,o){switch(e.message){case"update":te(me(document));break;case"sponsorStart":Le(),o({creatingSegment:Ue()});break;case"isInfoFound":o({found:S,sponsorTimes:T,onMobileYouTube:P}),!e.updating&&$&&null!=document.getElementById("sponsorBlockPopupContainer")&&Re(),$=!0;break;case"getVideoID":o({videoID:k,creatingSegment:Ue()});break;case"getChannelID":o({channelID:b.id});break;case"isChannelWhitelisted":o({value:j});break;case"whitelistChange":j=e.value,ue(k);break;case"submitTimes":We();break;case"refreshSegments":return ue(k,!1).then(()=>o({found:S,sponsorTimes:T,onMobileYouTube:P})),!0}}function ee(e){for(const t in e)switch(t){case"hideVideoPlayerControls":case"hideInfoButtonPlayerControls":case"hideDeleteButtonPlayerControls":Ie()}}function te(e){return n(this,void 0,void 0,(function*(){if((k!==e||!g.isVisible(w))&&(k=e,function(){var e;F=0,_=-1,T=null,z=0,I=[],E=null,j=!1,b={status:s.ChannelIDStatus.Fetching,id:null},N=[],null!==H&&H.clear(),S=!1,R=null!==R,V=!0,X=!1;for(let t=0;t<C.length;t++)null===(e=C.pop())||void 0===e||e.close();null==W||W.disable(),null==q||q.setVisibility(!1)}(),e)){if(yield r.wait(()=>null!==i.default.config,5e3,1),i.default.config.checkForUnlistedVideos){if(!confirm("SponsorBlock: You have the setting 'Ignore Unlisted/Private Videos' enabled. Due to a change in how segment fetching works, this setting is not needed anymore as it cannot leak your video ID to the server. It instead sends just the first 4 characters of a longer hash of the videoID to the server, and filters through a subset of the database. More info about this implementation can be found here: https://github.com/ajayyy/SponsorBlockServer/issues/25\n\nPlease click okay to confirm that you acknowledge this and continue using SponsorBlock."))return;i.default.config.checkForUnlistedVideos=!1}if(function(){n(this,void 0,void 0,(function*(){const e=i.default.config.whitelistedChannels,t=()=>{var e,t,o,n,i,s,r,a,c,l,u;return null!==(a=null!==(i=null!==(t=null===(e=null==E?void 0:E.videoDetails)||void 0===e?void 0:e.channelId)&&void 0!==t?t:null===(n=null===(o=document.querySelector(".ytd-channel-name a"))||void 0===o?void 0:o.getAttribute("href"))||void 0===n?void 0:n.replace(/\/.+\//,""))&&void 0!==i?i:null===(r=null===(s=document.querySelector(".ytp-title-channel-logo"))||void 0===s?void 0:s.getAttribute("href"))||void 0===r?void 0:r.replace(/https:\/.+\//,""))&&void 0!==a?a:null===(u=null===(l=null===(c=document.querySelector("a > .channel-profile"))||void 0===c?void 0:c.parentElement)||void 0===l?void 0:l.getAttribute("href"))||void 0===u?void 0:u.replace(/\/.+\//,"")};try{yield r.wait(()=>!!t(),6e3,20),b={status:s.ChannelIDStatus.Found,id:t().match(/^\/?([^\s/]+)/)[0]}}catch(e){return void(b={status:s.ChannelIDStatus.Failed,id:null})}null!=e&&b.status===s.ChannelIDStatus.Found&&e.includes(b.id)&&(j=!0),i.default.config.forceChannelCheck&&(null==T?void 0:T.length)>0&&he()}))}(),null===H)if(P){const e=new MutationObserver(oe);let t=null;r.wait(()=>(t=document.getElementById("player-control-container"),null!==t)).then(()=>{e.observe(document.getElementById("player-control-container"),{attributes:!0,childList:!0,subtree:!0})}).catch()}else r.wait(g.getControls).then(ne);Re(),ue(e),Ie(),G=[],Pe()}}))}function oe(){if(Ie(),null==W||W.updateMobileControls(),null!==H){if(document.body.contains(H.container)){const t=document.querySelector(".progress-bar-background");return void(null!==t&&(e=t,null===document.getElementById("previewbar")&&H.createElement(e)))}H.remove(),H=null}var e;ne()}function ne(){if(null!==H)return;const e=[".progress-bar-background",".ytp-progress-bar-container",".no-model.cue-range-markers",".vjs-progress-holder"];for(const t of e){const e=g.findValidElement(document.querySelectorAll(t));if(e){H=new c.default(e,P,U),ye();break}}}function ie(){ze(),ye()}function se(){ne(),ye(),Me()}function re(){null!==M&&(clearTimeout(M),M=null)}function ae(e=!1,t,o=!0){if(re(),X)return _=-1,void(F=0);if(!w||w.paused)return;if(null==t&&(t=w.currentTime),A&&!function(e){const t=t=>t.actionType===s.ActionType.Mute&&t.segment[0]<=e&&t.segment[1]>e;return(null==T?void 0:T.some(t))||G.some(t)}(t)){w.muted=!1,A=!1;for(const e of C)e.unmutedListener()}if(i.default.config.disableSkipping||j||b.status===s.ChannelIDStatus.Fetching&&i.default.config.forceChannelCheck)return;if(ce())return;const n=function(e,t,o){const{includedTimes:n,scheduledTimes:i}=Se(T,t,o),{scheduledTimes:s}=Se(T,t,o,e,!0,!0),r=i.indexOf(Math.min(...s)),a=ve(n,r),{includedTimes:c,scheduledTimes:l}=Se(G,t,o),{scheduledTimes:u}=Se(G,t,o,e,!1,!1),d=l.indexOf(Math.min(...u)),p=ve(c,d);return-1===d&&-1!==r||i[r]<l[d]?{array:n,index:r,endIndex:a,openNotice:!0}:{array:c,index:d,endIndex:p,openNotice:!1}}(t,e,o);if(-1===n.index)return;const a=n.array[n.index],c=[a.scheduledTime,n.array[n.endIndex].segment[1]],l=c[0]-t,u=k;let d=[n.array[n.index]];if(n.index!==n.endIndex){d=[];for(const e of n.array)Ee(e)&&e.segment[0]>=c[0]&&e.segment[1]<=c[1]&&d.push(e)}if(!Ne(a)&&!(null==G?void 0:G.some(e=>e.segment===a.segment)))return;const p=()=>{var e;let t=null,o=!1,i=!0;ce(u,a)||(w.currentTime>=c[0]&&w.currentTime<c[1]&&(Ce({v:w,skipTime:c,skippingSegments:d,openNotice:n.openNotice}),(null===(e=r.getCategorySelection(a.category))||void 0===e?void 0:e.option)===s.CategorySkipOption.ManualSkip||a.actionType===s.ActionType.Mute?t=c[0]+.001:(t=c[1],o=!0,i=!1)),ae(o,t,i))};l<=0?p():M=setTimeout(p,1e3*l*(1/w.playbackRate))}function ce(e,t){const o=me(document);return(o!==(e||k)||!(!t||T&&(null==T?void 0:T.some(e=>e.segment===t.segment))||G.some(e=>e.segment===t.segment)))&&(console.error("[SponsorBlock] The videoID recorded when trying to skip is different than what it should be."),console.error("[SponsorBlock] VideoID recorded: "+k+". Actual VideoID: "+o),te(o),!0)}function le(){var e;const t=g.findValidElement(document.querySelectorAll("video"));t&&t!==w&&(w=t,L.includes(w)||(L.push(w),w.addEventListener("loadstart",se),w.addEventListener("durationchange",ie),i.default.config.disableSkipping||(R=!1,w.addEventListener("play",()=>{(V||0!==w.currentTime)&&(V=!1,R&&(R=!1,T&&he()),ze(),(Math.abs(_-w.currentTime)>.3||_!==w.currentTime&&Date.now()-F>2e3)&&(F=Date.now(),_=w.currentTime,ae()))}),w.addEventListener("playing",()=>{(Math.abs(_-w.currentTime)>.3||_!==w.currentTime&&Date.now()-F>2e3)&&(F=Date.now(),_=w.currentTime,ae())}),w.addEventListener("seeking",()=>{w.paused||(F=Date.now(),_=w.currentTime,ae())}),w.addEventListener("ratechange",()=>ae()),w.addEventListener("videoSpeed_ratechange",()=>ae()),w.addEventListener("pause",()=>{_=-1,F=0,re()}),ae()),function(){W||(W=new h.SkipButtonControlBar({skip:e=>Ce({v:w,skipTime:e.segment,skippingSegments:[e],openNotice:!0,forceAutoSkip:!0}),onMobileYouTube:P}));W.attachToPage()}(),function(){q||(q=new f.CategoryPill);q.attachToPage(P,U,_e)}()),H&&!(null===(e=r.findReferenceNode())||void 0===e?void 0:e.contains(H.container))&&(H.remove(),H=null,ne()))}function ue(e,t=!0){var o,a;return n(this,void 0,void 0,(function*(){if(w&&g.isVisible(w)||le(),!w)return void setTimeout(()=>ue(e),100);!function(){const e=document.querySelector(".html5-video-container");e&&null===B&&!U&&(B=new MutationObserver(le),B.observe(e,{attributes:!0,childList:!0,subtree:!0}))}();let c=!1;const l=[];for(const e of i.default.config.categorySelections)l.push(e.name);const u={},d=g.getHashParams();d.requiredSegment&&(u.requiredSegment=d.requiredSegment);const h=(yield r.getHash(e,1)).substr(0,4),m=yield r.asyncRequestToServer("GET","/api/skipSegments/"+h,Object.assign({categories:l,actionTypes:de(),userAgent:`${chrome.runtime.id}`},u));if(null==m?void 0:m.ok){const n=null===(a=null===(o=JSON.parse(m.responseText))||void 0===o?void 0:o.filter(t=>t.videoID===e))||void 0===a?void 0:a.map(e=>e.segments)[0];if(!n||!n.length)return void pe();if(S=!0,null!==T&&t)for(let e=0;e<T.length;e++)T[e].source===s.SponsorSourceType.Local&&n.push(T[e]);const r=T||[];if(T=n,0!==i.default.config.minDuration)for(let e=0;e<T.length;e++)T[e].segment[1]-T[e].segment[0]<i.default.config.minDuration&&p.getCategoryActionType(T[e].category)!==s.CategoryActionType.POI&&(T[e].hidden=s.SponsorHideType.MinimumDuration);if(t)for(const e of r){const t=T.find(t=>e.UUID===t.UUID);t&&(t.hidden=e.hidden,t.category=e.category)}he(),(D==e||null==D&&!isNaN(w.duration))&&ye(),z=0}else 404===(null==m?void 0:m.status)?pe():z<15&&!c&&(c=!0,setTimeout(()=>{k&&0===(null==T?void 0:T.length)&&ue(k)},5e3+15e3*Math.random()+5e3*z),z++);!function(e){(function(){var e;return n(this,void 0,void 0,(function*(){const t=Date.now();if(t-i.default.config.lastIsVipUpdate>2592e5){i.default.config.lastIsVipUpdate=t;const o=yield r.asyncRequestToServer("GET","/api/isUserVIP",{userID:i.default.config.userID});if(o.ok){let t=!1;try{const n=null===(e=JSON.parse(o.responseText))||void 0===e?void 0:e.vip;"boolean"==typeof n&&(t=n)}catch(e){}return i.default.config.isVip=t,t}}return i.default.config.isVip}))})().then(t=>{t&&function(e){var t;n(this,void 0,void 0,(function*(){const o=(yield r.getHash(e,1)).substr(0,4),n=yield r.asyncRequestToServer("GET","/api/lockCategories/"+o);if(n.ok)try{const o=null===(t=JSON.parse(n.responseText).filter(t=>t.videoID===e)[0])||void 0===t?void 0:t.categories;Array.isArray(o)&&(N=o)}catch(e){}}))}(e)})}(e)}))}function de(){const e=[s.ActionType.Skip];return i.default.config.muteSegments&&e.push(s.ActionType.Mute),i.default.config.fullVideoSegments&&e.push(s.ActionType.Full),e}function pe(){i.default.config.refetchWhenNotFound&&(S=!1,setTimeout(()=>{k&&0===(null==T?void 0:T.length)&&ue(k)},1e4+3e4*Math.random()),z=0)}function he(){var e;if(!R&&T){let t=m.getStartTimeFromUrl(document.URL)||-1,o=!1,n=null;for(const e of T)if(e.segment[0]<=w.currentTime&&e.segment[0]>t&&e.segment[1]>w.currentTime&&p.getCategoryActionType(e.category)===s.CategoryActionType.Skippable){t=e.segment[0],n=e,o=!0;break}if(!o)for(const e of G)if(e.segment[0]<=w.currentTime&&e.segment[0]>t&&e.segment[1]>w.currentTime&&p.getCategoryActionType(e.category)===s.CategoryActionType.Skippable){t=e.segment[0],n=e,o=!0;break}const i=T.filter(e=>e.segment[1]>w.currentTime&&p.getCategoryActionType(e.category)===s.CategoryActionType.POI).sort((e,t)=>t.segment[0]-e.segment[0]);for(const t of i){const o=null===(e=r.getCategorySelection(t.category))||void 0===e?void 0:e.option;if(o!==s.CategorySkipOption.ShowOverlay&&(Ce({v:w,skipTime:t.segment,skippingSegments:[t],openNotice:!0,unskipTime:w.currentTime}),o===s.CategorySkipOption.AutoSkip))break}const a=T.filter(e=>e.actionType===s.ActionType.Full)[0];a&&(null==q||q.setSegment(a)),-1!==t?ae(void 0,t):ae()}}function me(e){const t=e.URL;return!t.includes("youtube.com")||t.includes("/watch")||t.includes("/shorts/")||t.includes("playlist")?fe(t):t.includes("/embed/")?ge(e,!1):t.includes("/channel/")||t.includes("/user/")||t.includes("/c/")?ge(e):fe(t)||ge(e)}function ge(e,t=!0){var o;const n=null===(o=e.querySelector("[data-sessionlink='feature=player-title']"))||void 0===o?void 0:o.getAttribute("href");return!!n&&(U=t,fe(n))}function fe(e){e.startsWith("https://www.youtube.com/tv#/")&&(e=e.replace("#",""));let t=null;try{t=new URL(e)}catch(t){return console.error("[SB] Unable to parse URL: "+e),!1}if(i.default.config&&i.default.config.invidiousInstances.includes(t.host))U=!0;else if("m.youtube.com"===t.host)P=!0;else if(!["m.youtube.com","www.youtube.com","www.youtube-nocookie.com","music.youtube.com"].includes(t.host))return i.default.config||r.wait(()=>null!==i.default.config).then(()=>te(fe(e))),!1;if(t.searchParams.has("v")&&["/watch","/watch/"].includes(t.pathname)||t.pathname.startsWith("/tv/watch")){const e=t.searchParams.get("v");return 11==e.length&&e}if(t.pathname.startsWith("/embed/")||t.pathname.startsWith("/shorts/"))try{const e=t.pathname.split("/")[2];if(e&&e.length>=11)return e.substr(0,11)}catch(t){return console.error("[SB] Video ID not valid for "+e),!1}return!1}function ye(){if(null===H)return;if(X)return void H.clear();if(null===w)return;const e=[];if(T&&T.forEach(t=>{t.hidden===s.SponsorHideType.Visible&&e.push({segment:t.segment,category:t.category,unsubmitted:!1,actionType:t.actionType,showLarger:p.getCategoryActionType(t.category)===s.CategoryActionType.POI})}),G.forEach(t=>{e.push({segment:t.segment,category:t.category,unsubmitted:!0,actionType:t.actionType,showLarger:p.getCategoryActionType(t.category)===s.CategoryActionType.POI})}),H.set(e.filter(e=>e.actionType!==s.ActionType.Full),null==w?void 0:w.duration),i.default.config.showTimeWithSkips){!function(e){if(P||U)return;(isNaN(e)||e<0)&&(e=0);const t=document.querySelector(".ytp-time-display.notranslate");if(!t)return;let o=document.getElementById("sponsorBlockDurationAfterSkips");null===o&&(o=document.createElement("span"),o.id="sponsorBlockDurationAfterSkips",o.classList.add("ytp-time-duration"),t.appendChild(o));const n=r.getFormattedTime((null==w?void 0:w.duration)-e);o.innerText=null==n||e<=0?"":" ("+n+")"}(r.getTimestampsDuration(e.map(({segment:e})=>e)))}D=k}function ve(e,t,o=!0){if(-1==t||!Ee(e[t])||e[t].actionType!==s.ActionType.Skip)return t;let n=t;for(let t=0;t<(null==e?void 0:e.length);t++){const i=e[t].segment,r=e[n].segment[1];i[0]<=r&&i[1]>r&&(!o||e[t].hidden===s.SponsorHideType.Visible)&&Ee(e[t])&&e[t].actionType===s.ActionType.Skip&&(n=t)}return n!==t&&(n=ve(e,n,o)),n}function Se(e,t,o,n,i=!1,r=!1){if(!e)return{includedTimes:[],scheduledTimes:[]};const a=[],c=[],l=e.map(e=>Object.assign(Object.assign({},e),{scheduledTime:e.segment[0]}));e.filter(e=>e.actionType===s.ActionType.Mute).forEach(e=>{l.some(t=>e.segment[1]===t.scheduledTime)||l.push(Object.assign(Object.assign({},e),{scheduledTime:e.segment[1]}))});for(let e=0;e<l.length;e++)!(void 0===n||o&&l[e].scheduledTime>=n||t&&l[e].scheduledTime<n&&l[e].segment[1]>n)||i&&!Ne(l[e])||r&&l[e].hidden!==s.SponsorHideType.Visible||p.getCategoryActionType(l[e].category)!==s.CategoryActionType.Skippable||(c.push(l[e].scheduledTime),a.push(l[e]));return{includedTimes:a,scheduledTimes:c}}function Te(e,t=!0){w.currentTime=e,t&&w.paused&&w.play()}function ke(e,t,o){if(!i.default.config.trackViewCount||!i.default.config.trackViewCountInPrivate&&chrome.extension.inIncognitoContext)return;let n=!1;for(const s of e){const e=null==T?void 0:T.findIndex(e=>e.segment===s.segment);-1===e||I[e]||(I[e]=!0,n||(i.default.config.minutesSaved=i.default.config.minutesSaved+t/60,i.default.config.skipCount=i.default.config.skipCount+1,n=!0),o&&r.asyncRequestToServer("POST","/api/viewedVideoSponsorTime?UUID="+s.UUID))}}function Ce({v:e,skipTime:t,skippingSegments:o,openNotice:n,forceAutoSkip:r,unskipTime:a}){if(i.default.config.disableSkipping)return;const c=r||Ee(o[0]);if((c||G.some(e=>e.segment===o[0].segment))&&e.currentTime!==t[1])switch(o[0].actionType){case s.ActionType.Skip:e.loop&&e.duration>1&&t[1]>=e.duration-1?e.currentTime=0:"Apple Computer, Inc."===navigator.vendor&&e.duration>1&&t[1]>=e.duration?e.currentTime=e.duration-.001:e.currentTime=t[1];break;case s.ActionType.Mute:e.muted||(e.muted=!0,A=!0)}if(c&&i.default.config.audioNotificationOnSkip){const e=new Audio(chrome.runtime.getURL("icons/beep.ogg"));e.volume=.1*w.volume,e.play()}if(c||1!==o.length||p.getCategoryActionType(o[0].category)!==s.CategoryActionType.POI){if(n&&(!i.default.config.dontShowNotice||!c)){const e=new l.default(o,c,Q,a);P&&e.setShowKeybindHint(!1),C.push(e),null==x||x.setShowKeybindHint(!1),x=e}}else W.enable(o[0]),P&&W.setShowKeybindHint(!1),null==x||x.setShowKeybindHint(!1),x=W;c&&ke(o,t[1]-t[0],!0)}function be(e,t=null){e.actionType===s.ActionType.Mute?(w.muted=!1,A=!1):w.currentTime=null!=t?t:e.segment[0]+.001}function we(e){if(e.actionType===s.ActionType.Mute)w.muted=!0,A=!0;else{const t=Math.max(e.segment[1]-w.currentTime,0),o=t/(e.segment[1]-e.segment[0])>.5;w.currentTime=e.segment[1],ke([e],t,o),ae(!0,e.segment[1],!1)}}function xe(e,t,o,n,i=!1){const s=document.getElementById(e+"Button");if(null!==s)return s;const r=document.createElement("button");r.draggable=i,r.id=e+"Button",r.classList.add("playerButton"),r.classList.add("ytp-button"),r.setAttribute("title",chrome.i18n.getMessage(t)),r.addEventListener("click",()=>{o()});const a=document.createElement("img");return r.draggable=i,a.id=e+"Image",a.className="playerButtonImage",a.src=chrome.extension.getURL("icons/"+n),r.appendChild(a),K&&K.prepend(r),Y[e]={button:r,image:a,setupListener:!1},r}function Ee(e){var t;return(null===(t=r.getCategorySelection(e.category))||void 0===t?void 0:t.option)===s.CategorySkipOption.AutoSkip||i.default.config.autoSkipOnMusicVideos&&(null==T?void 0:T.some(e=>"music_offtopic"===e.category))&&p.getCategoryActionType(e.category)===s.CategoryActionType.Skippable}function Ne(e){var t;return e.actionType!==s.ActionType.Full&&(null===(t=r.getCategorySelection(e.category))||void 0===t?void 0:t.option)!==s.CategorySkipOption.ShowOverlay||i.default.config.autoSkipOnMusicVideos&&(null==T?void 0:T.some(e=>"music_offtopic"===e.category))}function Me(){var e;return n(this,void 0,void 0,(function*(){if(P)return;K=yield r.wait(g.getControls).catch(),xe("startSegment","sponsorStart",()=>Ve(()=>Le()),"PlayerStartIconSponsorBlocker.svg"),xe("cancelSegment","sponsorCancel",()=>Ve(()=>function(){Ue()&&(G.splice(G.length-1,1),i.default.config.segmentTimes.set(k,G),G.length<=0&&He());Ae(),Pe(!1)}()),"PlayerCancelSegmentIconSponsorBlocker.svg"),xe("delete","clearTimes",()=>Ve(()=>function(){const e=k,t=i.default.config.segmentTimes.get(e);if(null!=t&&t.length>0){const o=chrome.i18n.getMessage("clearThis")+Ke(t)+"\n"+chrome.i18n.getMessage("confirmMSG");if(!confirm(o))return;He(),i.default.config.segmentTimes.delete(e),G=[],ye(),Ae()}}()),"PlayerDeleteIconSponsorBlocker.svg"),xe("submit","SubmitTimes",We,"PlayerUploadIconSponsorBlocker.svg"),xe("info","openPopup",De,"PlayerInfoIconSponsorBlocker.svg");const t=g.getControls();i.default.config.autoHideInfoButton&&!U&&t&&(null===(e=Y.info)||void 0===e?void 0:e.button)&&!O.includes(t)&&(O.push(t),y.AnimationUtils.setupAutoHideAnimation(Y.info.button,t))}))}function Ie(){return n(this,void 0,void 0,(function*(){k&&!P&&(yield Me(),Ae(),i.default.config.hideInfoButtonPlayerControls||document.URL.includes("/embed/")||U?Y.info.button.style.display="none":Y.info.button.style.removeProperty("display"))}))}function Ae(){if(!k||P)return;const e=!i.default.config.hideVideoPlayerControls&&!U;let t=!1,o=!1,n=!1;e&&(t=Ue(),o=G.length>0,n=G.length>1||G.length>0&&!t),Y.startSegment.button.style.display=e?"unset":"none",Y.cancelSegment.button.style.display=e&&t?"unset":"none",e&&(t?(Y.startSegment.image.src=chrome.extension.getURL("icons/PlayerStopIconSponsorBlocker.svg"),Y.startSegment.button.setAttribute("title",chrome.i18n.getMessage("sponsorEnd"))):(Y.startSegment.image.src=chrome.extension.getURL("icons/PlayerStartIconSponsorBlocker.svg"),Y.startSegment.button.setAttribute("title",chrome.i18n.getMessage("sponsorStart")))),Y.submit.button.style.display=o&&!i.default.config.hideUploadButtonPlayerControls?"unset":"none",Y.delete.button.style.display=n&&!i.default.config.hideDeleteButtonPlayerControls?"unset":"none"}function Be(){var e,t;return"M 18,11 V 7 l -5,5 5,5 v -4 c 3.3,0 6,2.7 6,6 0,3.3 -2.7,6 -6,6 -3.3,0 -6,-2.7 -6,-6 h -2 c 0,4.4 3.6,8 8,8 4.4,0 8,-3.6 8,-8 0,-4.4 -3.6,-8 -8,-8 z"===(null===(t=null===(e=document.querySelector(".ytp-play-button"))||void 0===e?void 0:e.querySelector(".ytp-svg-fill"))||void 0===t?void 0:t.getAttribute("d"))?null==w?void 0:w.duration:w.currentTime}function Le(){const e=Math.round(1e3*(Be()+Number.EPSILON))/1e3;if(Ue()){const t=Oe(),o=t.segment[0],n=e;t.segment=[Math.min(o,n),Math.max(o,n)]}else G.push({segment:[e],UUID:r.generateUserID(),category:i.default.config.defaultCategory,actionType:s.ActionType.Skip,source:s.SponsorSourceType.Local});i.default.config.segmentTimes.set(k,G),ue(k),Ae(),Pe(!1)}function Oe(){return G[G.length-1]}function Ue(){var e;const t=Oe();return t&&2!==(null===(e=null==t?void 0:t.segment)||void 0===e?void 0:e.length)}function Pe(e=!0){const t=i.default.config.segmentTimes.get(k);if(e&&null!=t){G=[];for(const e of t)G.push({segment:e.segment,UUID:e.UUID,category:e.category,actionType:e.actionType,source:e.source})}ye(),null!==w&&ae(),null!==J&&J.update(),function(){const e=g.getHashParams().segments;if(Array.isArray(e))for(const t of e)Array.isArray(t.segment)&&(G.some(e=>e.segment[0]===t.segment[0]&&e.segment[1]==e.segment[1])||G.push({segment:t.segment,UUID:r.generateUserID(),category:t.category?t.category:i.default.config.defaultCategory,actionType:t.actionType?t.actionType:s.ActionType.Skip,source:s.SponsorSourceType.Local}))}()}function De(){null==document.getElementById("sponsorBlockPopupContainer")&&($=!1,Y.info&&(Y.info.button.style.display="none"),function(e,t,o){const n=new XMLHttpRequest;n.open(e,t,!0),null!=o&&(n.onreadystatechange=function(){o(n,!1)},n.onerror=function(){o(n,!0)});n.send()}("GET",chrome.extension.getURL("popup.html"),(function(e){if(4==e.readyState&&200==e.status){const t=document.createElement("div");t.id="sponsorBlockPopupContainer";let o=e.responseText;o=o.replace(/<head>[\S\s]*<\/head>/gi,""),o=o.replace(/<body/gi,"<div"),o=o.replace(/<\/body/gi,"</div"),o=o.replace(/<html/gi,"<div"),o=o.replace(/<\/html/gi,"</div"),t.innerHTML=o;const n=document.createElement("div");n.innerText=chrome.i18n.getMessage("closePopup"),n.classList.add("smallLink"),n.setAttribute("align","center"),n.addEventListener("click",Re),n.style.color="var(--yt-spec-text-primary)",t.prepend(n);const i=document.querySelectorAll("#secondary");let s=null;for(let e=0;e<i.length;e++)null!==i[e].firstElementChild&&(s=i[e]);null==s&&(s=document.getElementById("watch7-sidebar-contents"));const r=t.querySelector("#sponsorBlockPopupLogo"),c=t.querySelector("#sbPopupIconSettings"),l=t.querySelector("#sbPopupIconEdit"),u=t.querySelector("#sbPopupIconCopyUserID"),d=t.querySelector("#sbPopupIconCheck"),p=t.querySelector("#refreshSegments");r.src=chrome.extension.getURL("icons/IconSponsorBlocker256px.png"),c.src=chrome.extension.getURL("icons/settings.svg"),l.src=chrome.extension.getURL("icons/pencil.svg"),u.src=chrome.extension.getURL("icons/clipboard.svg"),d.src=chrome.extension.getURL("icons/check.svg"),p.src=chrome.extension.getURL("icons/refresh.svg"),s.insertBefore(t,s.firstChild),a.default(Z)}})))}function Re(){const e=document.getElementById("sponsorBlockPopupContainer");null!==e&&(e.remove(),!document.URL.includes("/embed/")&&Y.info&&(Y.info.button.style.display="unset"))}function Ve(e){return Re(),e()}function Fe(e,t,o,i){return n(this,void 0,void 0,(function*(){null!=i&&(i.addVoteButtonInfo.bind(i)(chrome.i18n.getMessage("Loading")),i.setNoticeInfoMessage.bind(i)());const n=yield _e(e,t,o);null!=n&&null!=i&&(1==n.successType||-1==n.successType&&429==n.statusCode?i.afterVote.bind(i)(r.getSponsorTimeFromUUID(T,t),e,o):-1==n.successType&&(403===n.statusCode&&n.responseText.startsWith("Vote rejected due to a warning from a moderator.")?i.setNoticeInfoMessageWithOnClick.bind(i)(()=>{d.openWarningChat(n.responseText),i.closeListener.call(i)},chrome.i18n.getMessage("voteRejectedWarning")):i.setNoticeInfoMessage.bind(i)(v.GenericUtils.getErrorMessage(n.statusCode,n.responseText)),i.resetVoteButtonInfo.bind(i)()))}))}function _e(e,t,o){return n(this,void 0,void 0,(function*(){const n=r.getSponsorIndexFromUUID(T,t);if(-1!=n&&T[n].source!==s.SponsorSourceType.Local){if(0===e&&I[n]||1===e&&!I[n]){let t=1;0==e&&(t=-1,I[n]=!1),i.default.config.minutesSaved=i.default.config.minutesSaved+t*(T[n].segment[1]-T[n].segment[0])/60,i.default.config.skipCount=i.default.config.skipCount+t}return new Promise(n=>{chrome.runtime.sendMessage({message:"submitVote",type:e,UUID:t,category:o},n)})}}))}function je(){i.default.config.dontShowNotice=!0,function(){const e=document.getElementsByClassName("sponsorSkipNotice");for(let t=0;t<e.length;t++)e[t].remove()}()}function He(){null==J||J.close(),J=null}function We(){if(null!==J)return J.close(),void(J=null);void 0!==G&&G.length>0&&(J=new u.default(Q,qe))}function qe(){return n(this,void 0,void 0,(function*(){if(g.isVisible(document.querySelector(".ytp-live-badge")))return void alert(chrome.i18n.getMessage("liveOrPremiere"));Y.submit.image.src=chrome.extension.getURL("icons/PlayerUploadIconSponsorBlocker.svg");const e=y.AnimationUtils.applyLoadingAnimation(Y.submit.button,1,()=>Ae());for(let e=0;e<G.length;e++)G[e].segment[1]>w.duration&&(G[e].segment[1]=w.duration);if(i.default.config.segmentTimes.set(k,G),i.default.config.minDuration>0)for(let e=0;e<G.length;e++){const t=G[e].segment[1]-G[e].segment[0];if(t>0&&t<i.default.config.minDuration){const e=chrome.i18n.getMessage("shortCheck")+"\n\n"+Ke(G);if(!confirm(e))return}}const t=yield r.asyncRequestToServer("POST","/api/skipSegments",{videoID:k,userID:i.default.config.userID,segments:G,videoDuration:null==w?void 0:w.duration,userAgent:`${chrome.runtime.id}/v${chrome.runtime.getManifest().version}`});if(200===t.status){e(),i.default.config.segmentTimes.delete(k);const o=G;try{const e=JSON.parse(t.responseText);if((null==e?void 0:e.length)===o.length)for(let t=0;t<e.length;t++)o[t].UUID=e[t].UUID,o[t].source=s.SponsorSourceType.Server}catch(e){}T=(T||[]).concat(o),i.default.config.sponsorTimesContributed=i.default.config.sponsorTimesContributed+G.length,i.default.config.submissionCountSinceCategories=i.default.config.submissionCountSinceCategories+1,G=[],ye()}else Y.submit.button.style.animation="unset",Y.submit.image.src=chrome.extension.getURL("icons/PlayerUploadFailedIconSponsorBlocker.svg"),403===t.status&&t.responseText.startsWith("Submission rejected due to a warning from a moderator.")?d.openWarningChat(t.responseText):alert(v.GenericUtils.getErrorMessage(t.status,t.responseText))}))}function Ke(e){let t="";for(let o=0;o<e.length;o++)for(let n=0;n<e[o].segment.length;n++){let i=r.getFormattedTime(e[o].segment[n]);1==n?i=" to "+i:o>0&&(i=", "+i),t+=i}return t}function Ye(e){var t,o,n,s,r;if(["textarea","input"].includes(null===(o=null===(t=document.activeElement)||void 0===t?void 0:t.tagName)||void 0===o?void 0:o.toLowerCase())||(null===(r=null===(s=null===(n=document.activeElement)||void 0===n?void 0:n.id)||void 0===s?void 0:s.toLowerCase())||void 0===r?void 0:r.includes("editable")))return;const a=e.key,c=i.default.config.skipKeybind,l=i.default.config.startSponsorKeybind,u=i.default.config.submitKeybind;switch(a){case c:x&&x.toggleSkip.call(x);break;case l:Le();break;case u:We()}}function ze(){const e=X;X=document.getElementsByClassName("ad-showing").length>0,e!=X&&(ye(),Ie())}chrome.runtime.onMessage.addListener(Z),i.default.configListeners.includes(ee)||i.default.configListeners.push(ee)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(0),i=new(o(2).default);t.default=class{constructor(e,t,o){this.segments=[],this.videoDuration=0,this.container=document.createElement("ul"),this.container.id="previewbar",this.parent=e,this.onMobileYouTube=t,this.onInvidious=o,this.createElement(e),this.setupHoverText()}setupHoverText(){if(this.onMobileYouTube||this.onInvidious)return;this.categoryTooltip=document.createElement("div"),this.categoryTooltip.className="ytp-tooltip-title sponsorCategoryTooltip";const e=document.querySelector(".ytp-tooltip-text-wrapper");if(!e||!e.parentElement)return;this.tooltipContainer=e.parentElement;const t=e.querySelector(".ytp-tooltip-title");if(!this.tooltipContainer||!t)return;e.insertBefore(this.categoryTooltip,t.nextSibling);const o=document.querySelector(".ytp-progress-bar-container");if(!o)return;let n=!1;o.addEventListener("mouseenter",()=>{n=!0}),o.addEventListener("mouseleave",()=>{n=!1}),new MutationObserver(t=>{if(!n||!this.categoryTooltip||!this.tooltipContainer)return;if(1===t.length&&t[0].target.classList.contains("sponsorCategoryTooltip"))return;const o=e.querySelectorAll(".ytp-tooltip-text");let s=null,r=!1;for(const e of o){e.classList.contains("ytp-tooltip-text-no-title")&&(r=!0);const t=e.textContent;if(null!==t&&0!==t.length&&(s=i.getFormattedTimeToSeconds(t),null!==s))break}if(null===s)return;let a=null,c=1/0;for(const e of this.segments){const t=e.segment[1]-e.segment[0],o=this.getMinimumSize(e.showLarger),n=0!==t?e.segment[0]:Math.floor(e.segment[0]),i=t>o?e.segment[1]:Math.ceil(e.segment[0]+o);n<=s&&i>=s&&t<c&&(c=t,a=e)}null===a&&this.tooltipContainer.classList.contains("sponsorCategoryTooltipVisible")?this.tooltipContainer.classList.remove("sponsorCategoryTooltipVisible"):null!==a&&(this.tooltipContainer.classList.add("sponsorCategoryTooltipVisible"),a.unsubmitted?this.categoryTooltip.textContent=chrome.i18n.getMessage("unsubmitted")+" "+i.shortCategoryName(a.category):this.categoryTooltip.textContent=i.shortCategoryName(a.category),this.categoryTooltip.classList.toggle("ytp-tooltip-text-no-title",r))}).observe(e,{childList:!0,subtree:!0})}createElement(e){this.parent=e,this.onMobileYouTube?(e.style.backgroundColor="rgba(255, 255, 255, 0.3)",e.style.opacity="1",this.container.style.transform="none"):this.onInvidious||(this.parent.addEventListener("mouseenter",()=>this.container.classList.add("hovered")),this.parent.addEventListener("mouseleave",()=>this.container.classList.remove("hovered"))),this.parent.prepend(this.container)}clear(){for(this.videoDuration=0,this.segments=[];this.container.firstChild;)this.container.removeChild(this.container.firstChild)}set(e,t){this.clear(),e&&(this.segments=e,this.videoDuration=t,this.segments.sort(({segment:e},{segment:t})=>t[1]-t[0]-(e[1]-e[0])).forEach(e=>{const t=this.createBar(e);this.container.appendChild(t)}))}createBar({category:e,unsubmitted:t,segment:o,showLarger:i}){var s,r;const a=document.createElement("li");a.classList.add("previewbar"),a.innerHTML=i?"&nbsp;&nbsp;":"&nbsp;";const c=(t?"preview-":"")+e;a.setAttribute("sponsorblock-category",c),a.style.backgroundColor=null===(s=n.default.config.barTypes[c])||void 0===s?void 0:s.color,this.onMobileYouTube||(a.style.opacity=null===(r=n.default.config.barTypes[c])||void 0===r?void 0:r.opacity),a.style.position="absolute";const l=Math.min(o[1],this.videoDuration)-o[0];l>0&&(a.style.width=this.timeToPercentage(l));const u=o[1]?Math.min(this.videoDuration,o[0]):o[0];return a.style.left=this.timeToPercentage(u),a}remove(){this.container.remove(),this.categoryTooltip&&(this.categoryTooltip.remove(),this.categoryTooltip=void 0),this.tooltipContainer&&(this.tooltipContainer.classList.remove("sponsorCategoryTooltipVisible"),this.tooltipContainer=void 0)}timeToPercentage(e){return Math.min(100,e/this.videoDuration*100)+"%"}getMinimumSize(e=!1){return this.videoDuration*(e?.006:.003)}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(1),i=o(6),s=new(o(2).default),r=o(27),a=o(4),c=o(0),l=o(10);t.default=class{constructor(e,t=!1,o,l=null){this.skipNoticeRef=n.createRef(),this.segments=e,this.autoSkip=t,this.contentContainer=o;const u=s.findReferenceNode(),d=document.getElementsByClassName("sponsorSkipNotice").length;let p="";for(const e of this.segments)p+=e.UUID;p+=d,this.noticeElement=document.createElement("div"),this.noticeElement.id="sponsorSkipNoticeContainer"+p,u.prepend(this.noticeElement),i.render(n.createElement(r.default,{segments:e,autoSkip:t,contentContainer:o,ref:this.skipNoticeRef,closeListener:()=>this.close(),smaller:c.default.config.noticeVisibilityMode>=a.NoticeVisbilityMode.MiniForAll||c.default.config.noticeVisibilityMode>=a.NoticeVisbilityMode.MiniForAutoSkip&&t,unskipTime:l}),this.noticeElement)}setShowKeybindHint(e){var t,o;null===(o=null===(t=this.skipNoticeRef)||void 0===t?void 0:t.current)||void 0===o||o.setState({showKeybindHint:e})}close(){i.unmountComponentAtNode(this.noticeElement),this.noticeElement.remove();const e=this.contentContainer().skipNotices;e.splice(e.indexOf(this),1)}toggleSkip(){var e,t;null===(t=null===(e=this.skipNoticeRef)||void 0===e?void 0:e.current)||void 0===t||t.prepAction(l.SkipNoticeAction.Unskip)}unmutedListener(){var e,t;null===(t=null===(e=this.skipNoticeRef)||void 0===e?void 0:e.current)||void 0===t||t.unmutedListener()}}},,,,,function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(1),i=o(3),s=o(0),r=o(4),a=o(14),c=o(15),l=new(o(2).default),u=o(5),d=o(16),p=o(17),h=o(28),m=o(10);class g extends n.Component{constructor(e){var t,o;super(e),this.noticeRef=n.createRef(),this.categoryOptionRef=n.createRef(),this.segments=e.segments,this.autoSkip=e.autoSkip,this.contentContainer=e.contentContainer;const i=u.getSkippingText(this.segments,this.props.autoSkip),r=document.getElementsByClassName("sponsorSkipNoticeParent");this.amountOfPreviousNotices=r.length,this.showInSecondSlot=r.length>0&&[...r].some(e=>!e.classList.contains("secondSkipNotice")),this.segments.length>1&&this.segments.sort((e,t)=>e.segment[0]-t.segment[0]);for(const e of this.segments)this.idSuffix+=e.UUID;this.idSuffix+=this.amountOfPreviousNotices,this.selectedColor=s.default.config.colorPalette.red,this.unselectedColor=s.default.config.colorPalette.white,this.lockedColor=s.default.config.colorPalette.locked,this.state={noticeTitle:i,messages:[],messageOnClick:null,maxCountdownTime:()=>s.default.config.skipNoticeDuration,countdownTime:s.default.config.skipNoticeDuration,countdownText:null,skipButtonText:this.getUnskipText(),skipButtonCallback:e=>this.unskip(e),showSkipButton:!0,editing:!1,choosingCategory:!1,thanksForVotingText:null,actionState:m.SkipNoticeAction.None,showKeybindHint:null===(t=this.props.showKeybindHint)||void 0===t||t,smaller:null!==(o=this.props.smaller)&&void 0!==o&&o,voted:new Array(this.props.segments.length).fill(m.SkipNoticeAction.None),copied:new Array(this.props.segments.length).fill(m.SkipNoticeAction.None)},this.autoSkip||Object.assign(this.state,this.getUnskippedModeInfo(0,this.getSkipText()))}render(){const e={};this.contentContainer().onMobileYouTube&&(e.bottom="4em",e.transform="scale(0.8) translate(10%, 10%)");const t=this.props.smaller?this.getSkipButton():null;return n.createElement(a.default,{noticeTitle:this.state.noticeTitle,amountOfPreviousNotices:this.amountOfPreviousNotices,showInSecondSlot:this.showInSecondSlot,idSuffix:this.idSuffix,fadeIn:!0,startFaded:s.default.config.noticeVisibilityMode>=r.NoticeVisbilityMode.FadedForAll||s.default.config.noticeVisibilityMode>=r.NoticeVisbilityMode.FadedForAutoSkip&&this.autoSkip,timed:!0,maxCountdownTime:this.state.maxCountdownTime,style:e,biggerCloseButton:this.contentContainer().onMobileYouTube,ref:this.noticeRef,closeListener:()=>this.closeListener(),smaller:this.state.smaller,limitWidth:!0,firstColumn:t,bottomRow:[...this.getMessageBoxes(),...this.getBottomRow()],onMouseEnter:()=>this.onMouseEnter()})}getBottomRow(){return[n.createElement("tr",{id:"sponsorSkipNoticeSecondRow"+this.idSuffix,key:0},this.state.thanksForVotingText?n.createElement("td",{id:"sponsorTimesVoteButtonInfoMessage"+this.idSuffix,className:"sponsorTimesInfoMessage sponsorTimesVoteButtonMessage",style:{marginRight:"10px"}},n.createElement("span",{style:{marginRight:"10px"}},this.state.thanksForVotingText),n.createElement("button",{id:"sponsorTimesContinueVotingContainer"+this.idSuffix,className:"sponsorSkipObject sponsorSkipNoticeButton",title:"Continue Voting",onClick:()=>this.setState({thanksForVotingText:null,messages:[]})},chrome.i18n.getMessage("ContinueVoting"))):n.createElement("td",{id:"sponsorTimesVoteButtonsContainer"+this.idSuffix,className:"sponsorTimesVoteButtonsContainer"},n.createElement("div",{id:"sponsorTimesDownvoteButtonsContainerUpvote"+this.idSuffix,className:"voteButton",style:{marginRight:"5px"},title:chrome.i18n.getMessage("upvoteButtonInfo"),onClick:()=>this.prepAction(m.SkipNoticeAction.Upvote)},n.createElement(d.default,{fill:this.state.actionState===m.SkipNoticeAction.Upvote?this.selectedColor:this.unselectedColor})),n.createElement("div",{id:"sponsorTimesDownvoteButtonsContainerDownvote"+this.idSuffix,className:"voteButton",style:{marginRight:"5px",marginLeft:"5px"},title:chrome.i18n.getMessage("reportButtonInfo"),onClick:()=>this.prepAction(m.SkipNoticeAction.Downvote)},n.createElement(p.default,{fill:m.downvoteButtonColor(this.segments,this.state.actionState,m.SkipNoticeAction.Downvote)})),n.createElement("div",{id:"sponsorTimesDownvoteButtonsContainerCopyDownvote"+this.idSuffix,className:"voteButton",style:{marginLeft:"5px"},onClick:()=>this.openEditingOptions()},n.createElement(h.default,{fill:!0===this.state.editing||this.state.actionState===m.SkipNoticeAction.CopyDownvote||!0===this.state.choosingCategory?this.selectedColor:this.unselectedColor}))),this.props.smaller?null:this.getSkipButton(),this.autoSkip?n.createElement("td",{className:"sponsorSkipNoticeRightSection",key:1},n.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton sponsorSkipNoticeRightButton",onClick:this.contentContainer().dontShowNoticeAgain},chrome.i18n.getMessage("Hide"))):""),this.state.editing&&!this.state.thanksForVotingText&&!(this.state.choosingCategory||this.state.actionState===m.SkipNoticeAction.CopyDownvote)&&n.createElement("tr",{id:"sponsorSkipNoticeEditSegmentsRow"+this.idSuffix,key:2},n.createElement("td",{id:"sponsorTimesEditSegmentsContainer"+this.idSuffix},n.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton",title:chrome.i18n.getMessage("CopyDownvoteButtonInfo"),style:{color:m.downvoteButtonColor(this.segments,this.state.actionState,m.SkipNoticeAction.Downvote)},onClick:()=>this.prepAction(m.SkipNoticeAction.CopyDownvote)},chrome.i18n.getMessage("CopyAndDownvote")),n.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton",title:chrome.i18n.getMessage("ChangeCategoryTooltip"),style:{color:this.state.actionState===m.SkipNoticeAction.CategoryVote&&1==this.state.editing?this.selectedColor:this.unselectedColor},onClick:()=>this.resetStateToStart(m.SkipNoticeAction.CategoryVote,!0,!0)},chrome.i18n.getMessage("incorrectCategory")))),this.state.choosingCategory&&!this.state.thanksForVotingText&&n.createElement("tr",{id:"sponsorSkipNoticeCategoryChooserRow"+this.idSuffix,key:3},n.createElement("td",null,n.createElement("select",{id:"sponsorTimeCategories"+this.idSuffix,className:"sponsorTimeCategories sponsorTimeEditSelector",defaultValue:this.segments[0].category,ref:this.categoryOptionRef},this.getCategoryOptions()),1===this.segments.length&&n.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton",onClick:()=>this.prepAction(m.SkipNoticeAction.CategoryVote)},chrome.i18n.getMessage("submit")))),this.state.actionState!==m.SkipNoticeAction.None&&this.segments.length>1&&!this.state.thanksForVotingText&&n.createElement("tr",{id:"sponsorSkipNoticeSubmissionOptionsRow"+this.idSuffix,key:4},n.createElement("td",{id:"sponsorTimesSubmissionOptionsContainer"+this.idSuffix},this.getSubmissionChooser()))]}getSkipButton(){if(this.state.showSkipButton&&(this.segments.length>1||u.getCategoryActionType(this.segments[0].category)!==r.CategoryActionType.POI||this.props.unskipTime)){const e={marginLeft:"4px",color:this.state.actionState===m.SkipNoticeAction.Unskip?this.selectedColor:this.unselectedColor};return this.contentContainer().onMobileYouTube&&(e.padding="20px",e.minWidth="100px"),n.createElement("span",{className:"sponsorSkipNoticeUnskipSection"},n.createElement("button",{id:"sponsorSkipUnskipButton"+this.idSuffix,className:"sponsorSkipObject sponsorSkipNoticeButton",style:e,onClick:()=>this.prepAction(m.SkipNoticeAction.Unskip)},this.state.skipButtonText+(this.state.showKeybindHint?" ("+s.default.config.skipKeybind+")":"")))}}getSubmissionChooser(){const e=[];for(let t=0;t<this.segments.length;t++)e.push(n.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton",style:{opacity:this.getSubmissionChooserOpacity(t),color:this.getSubmissionChooserColor(t)},onClick:()=>this.performAction(t),key:"submission"+t+this.segments[t].category+this.idSuffix},t+1+". "+chrome.i18n.getMessage("category_"+this.segments[t].category)));return e}getSubmissionChooserOpacity(e){const t=this.state.actionState===m.SkipNoticeAction.Upvote,o=this.state.actionState==m.SkipNoticeAction.Downvote,n=this.state.actionState==m.SkipNoticeAction.CopyDownvote;return t&&this.state.voted[e]==m.SkipNoticeAction.Upvote||o&&this.state.voted[e]==m.SkipNoticeAction.Downvote||n&&this.state.copied[e]==m.SkipNoticeAction.CopyDownvote?.35:1}getSubmissionChooserColor(e){const t=this.state.actionState==m.SkipNoticeAction.Downvote,o=this.state.actionState==m.SkipNoticeAction.CopyDownvote;return s.default.config.isVip&&(t||o)&&1===this.segments[e].locked?this.lockedColor:this.unselectedColor}onMouseEnter(){this.state.smaller&&this.setState({smaller:!1})}getMessageBoxes(){if(0===this.state.messages.length)return[n.createElement("tr",{id:"sponsorSkipNoticeSpacer"+this.idSuffix,className:"sponsorBlockSpacer",key:"messageBoxSpacer"})];const e=[];for(let t=0;t<this.state.messages.length;t++)e.push(n.createElement("tr",{key:t+"_messageBox"},n.createElement("td",{key:t+"_messageBox"},n.createElement(c.default,{idSuffix:this.idSuffix,text:this.state.messages[t],onClick:this.state.messageOnClick,key:t+"_messageBox"}))));return e}prepAction(e){if(1===this.segments.length)this.performAction(0,e);else switch(null!=e?e:this.state.actionState){case m.SkipNoticeAction.None:this.resetStateToStart();break;case m.SkipNoticeAction.Upvote:this.resetStateToStart(m.SkipNoticeAction.Upvote);break;case m.SkipNoticeAction.Downvote:this.resetStateToStart(m.SkipNoticeAction.Downvote);break;case m.SkipNoticeAction.CategoryVote:this.resetStateToStart(m.SkipNoticeAction.CategoryVote,!0,!0);break;case m.SkipNoticeAction.CopyDownvote:this.resetStateToStart(m.SkipNoticeAction.CopyDownvote,!0);break;case m.SkipNoticeAction.Unskip:this.resetStateToStart(m.SkipNoticeAction.Unskip)}}performAction(e,t){switch(null!=t?t:this.state.actionState){case m.SkipNoticeAction.None:this.noAction(e);break;case m.SkipNoticeAction.Upvote:this.upvote(e);break;case m.SkipNoticeAction.Downvote:this.downvote(e);break;case m.SkipNoticeAction.CategoryVote:this.categoryVote(e);break;case m.SkipNoticeAction.CopyDownvote:this.copyDownvote(e);break;case m.SkipNoticeAction.Unskip:this.unskipAction(e);break;default:this.resetStateToStart()}}noAction(e){const t=this.state.voted;t[e]=m.SkipNoticeAction.None,this.setState({voted:t})}upvote(e){1===this.segments.length&&this.resetStateToStart(),this.contentContainer().vote(1,this.segments[e].UUID,void 0,this)}downvote(e){1===this.segments.length&&this.resetStateToStart(),this.contentContainer().vote(0,this.segments[e].UUID,void 0,this)}categoryVote(e){this.contentContainer().vote(void 0,this.segments[e].UUID,this.categoryOptionRef.current.value,this)}copyDownvote(e){const t=this.props.contentContainer().sponsorVideoID,o={segment:this.segments[e].segment,UUID:l.generateUserID(),category:this.segments[e].category,actionType:this.segments[e].actionType,source:r.SponsorSourceType.Local},n=s.default.config.segmentTimes.get(t)||[];n.push(o),s.default.config.segmentTimes.set(t,n),this.props.contentContainer().sponsorTimesSubmitting.push(o),this.props.contentContainer().updatePreviewBar(),this.props.contentContainer().resetSponsorSubmissionNotice(),this.props.contentContainer().updateEditButtonsOnPlayer(),this.contentContainer().vote(0,this.segments[e].UUID,void 0,this);const i=this.state.copied;i[e]=m.SkipNoticeAction.CopyDownvote,this.setState({copied:i})}unskipAction(e){this.state.skipButtonCallback(e)}openEditingOptions(){this.resetStateToStart(void 0,!0)}getCategoryOptions(){const e=[],t=i.categoryList.filter(e=>u.getCategoryActionType(e)===r.CategoryActionType.Skippable);for(const o of t)e.push(n.createElement("option",{value:o,key:o,className:this.getCategoryNameClass(o)},chrome.i18n.getMessage("category_"+o)));return e}getCategoryNameClass(e){return this.props.contentContainer().lockedCategories.includes(e)?"sponsorBlockLockedColor":""}unskip(e){this.contentContainer().unskipSponsorTime(this.segments[e],this.props.unskipTime),this.unskippedMode(e,this.getReskipText())}reskip(e){this.contentContainer().reskipSponsorTime(this.segments[e]);const t={skipButtonText:this.getUnskipText(),skipButtonCallback:this.unskip.bind(this),maxCountdownTime:()=>s.default.config.skipNoticeDuration,countdownTime:s.default.config.skipNoticeDuration};this.autoSkip||(t.noticeTitle=chrome.i18n.getMessage("noticeTitle")),this.setState(t,()=>{this.noticeRef.current.resetCountdown()})}unskippedMode(e,t){this.setState(this.getUnskippedModeInfo(e,t),()=>{this.noticeRef.current.resetCountdown()})}getUnskippedModeInfo(e,t){const o=u.getCategoryActionType(this.segments[e].category)===r.CategoryActionType.Skippable?()=>{const t=this.segments[e],o=Math.round((t.segment[1]-this.contentContainer().v.currentTime)*(1/this.contentContainer().v.playbackRate));return Math.max(o,s.default.config.skipNoticeDuration)}:this.state.maxCountdownTime;return{skipButtonText:t,skipButtonCallback:e=>this.reskip(e),maxCountdownTime:o,countdownTime:o()}}afterVote(e,t,o){const n=l.getSponsorIndexFromUUID(this.segments,e.UUID),s=i.wikiLinks[e.category],a=this.state.voted;switch(t){case 0:this.clearConfigListener(),this.setNoticeInfoMessageWithOnClick(()=>window.open(s),chrome.i18n.getMessage("OpenCategoryWikiPage")),a[n]=m.SkipNoticeAction.Downvote;break;case 1:a[n]=m.SkipNoticeAction.Upvote;break;case 20:a[n]=m.SkipNoticeAction.None}this.setState({voted:a}),this.addVoteButtonInfo(chrome.i18n.getMessage("voted")),e&&(0===t?e.hidden=r.SponsorHideType.Downvoted:o?(e.category=o,this.segments[n].category=o):1===t&&(e.hidden=r.SponsorHideType.Visible),this.contentContainer().updatePreviewBar())}setNoticeInfoMessageWithOnClick(e,...t){this.setState({messages:t,messageOnClick:t=>e(t)})}setNoticeInfoMessage(...e){this.setState({messages:e})}addVoteButtonInfo(e){this.setState({thanksForVotingText:e})}resetVoteButtonInfo(){this.setState({thanksForVotingText:null})}closeListener(){this.clearConfigListener(),this.props.closeListener()}clearConfigListener(){this.configListener&&(s.default.configListeners.splice(s.default.configListeners.indexOf(this.configListener),1),this.configListener=null)}unmutedListener(){1===this.props.segments.length&&this.props.segments[0].actionType===r.ActionType.Mute&&this.contentContainer().v.currentTime>=this.props.segments[0].segment[1]&&this.setState({showSkipButton:!1})}resetStateToStart(e=m.SkipNoticeAction.None,t=!1,o=!1){this.setState({actionState:e,editing:t,choosingCategory:o,thanksForVotingText:null,messages:[]})}getUnskipText(){switch(this.props.segments[0].actionType){case r.ActionType.Mute:return chrome.i18n.getMessage("unmute");case r.ActionType.Skip:default:return chrome.i18n.getMessage("unskip")}}getReskipText(){switch(this.props.segments[0].actionType){case r.ActionType.Mute:return chrome.i18n.getMessage("mute");case r.ActionType.Skip:default:return chrome.i18n.getMessage("reskip")}}getSkipText(){switch(this.props.segments[0].actionType){case r.ActionType.Mute:return chrome.i18n.getMessage("mute");case r.ActionType.Skip:default:return chrome.i18n.getMessage("skip")}}}t.default=g},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(1);t.default=({fill:e="#ffffff"})=>n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:e},n.createElement("path",{d:"M14.1 7.1l2.9 2.9L6.1 20.7l-3.6.7.7-3.6L14.1 7.1zm0-2.8L1.4 16.9 0 24l7.1-1.4L19.8 9.9l-5.7-5.7zm7.1 4.3L24 5.7 18.3 0l-2.8 2.8 5.7 5.7z"}))},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(1),i=o(6),s=new(o(2).default),r=o(30);t.default=class{constructor(e,t){this.noticeRef=n.createRef(),this.contentContainer=e,this.callback=t;const o=s.findReferenceNode();this.noticeElement=document.createElement("div"),this.noticeElement.id="submissionNoticeContainer",o.prepend(this.noticeElement),i.render(n.createElement(r.default,{contentContainer:e,callback:t,ref:this.noticeRef,closeListener:()=>this.close()}),this.noticeElement)}update(){this.noticeRef.current.forceUpdate()}close(){i.unmountComponentAtNode(this.noticeElement),this.noticeElement.remove()}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(1),i=o(0),s=o(14),r=o(15),a=o(31);class c extends n.Component{constructor(e){super(e),this.noticeRef=n.createRef(),this.contentContainer=e.contentContainer,this.callback=e.callback;const t=chrome.i18n.getMessage("confirmNoticeTitle");this.state={noticeTitle:t,messages:[],idSuffix:"SubmissionNotice"}}componentDidMount(){this.videoObserver=new MutationObserver(()=>{this.forceUpdate()}),this.videoObserver.observe(this.contentContainer().v,{attributes:!0})}componentWillUnmount(){this.videoObserver&&this.videoObserver.disconnect()}render(){return n.createElement(s.default,{noticeTitle:this.state.noticeTitle,idSuffix:this.state.idSuffix,ref:this.noticeRef,closeListener:this.cancel.bind(this),zIndex:5e3},this.getMessageBoxes(),n.createElement("tr",{id:"sponsorSkipNoticeMiddleRow"+this.state.idSuffix,className:"sponsorTimeMessagesRow",style:{maxHeight:this.contentContainer().v.offsetHeight-200+"px"}},n.createElement("td",{style:{width:"100%"}},this.getSponsorTimeMessages())),n.createElement("tr",{id:"sponsorSkipNoticeSecondRow"+this.state.idSuffix},n.createElement("td",{className:"sponsorSkipNoticeRightSection",style:{position:"relative"}},n.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton sponsorSkipNoticeRightButton",onClick:()=>window.open("https://wiki.sponsor.ajay.app/index.php/Guidelines")},chrome.i18n.getMessage(i.default.config.submissionCountSinceCategories>3?"guidelines":"readTheGuidelines")),n.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton sponsorSkipNoticeRightButton",onClick:this.submit.bind(this)},chrome.i18n.getMessage("submit")))))}getSponsorTimeMessages(){const e=[];this.timeEditRefs=[];const t=this.props.contentContainer().sponsorTimesSubmitting;for(let o=0;o<t.length;o++){const i=n.createRef();e.push(n.createElement(a.default,{key:t[o].UUID,idSuffix:this.state.idSuffix+o,index:o,contentContainer:this.props.contentContainer,submissionNotice:this,ref:i})),this.timeEditRefs.push(i)}return e}getMessageBoxes(){const e=[];for(let t=0;t<this.state.messages.length;t++)e.push(n.createElement(r.default,{idSuffix:this.state.idSuffix+t,text:this.state.messages[t],key:t}));return e}cancel(){this.noticeRef.current.close(!0),this.contentContainer().resetSponsorSubmissionNotice(),this.props.closeListener()}submit(){var e,t,o;for(const e of this.timeEditRefs)e.current.saveEditTimes();const n=this.props.contentContainer().sponsorTimesSubmitting;for(const e of n)if("chooseACategory"===e.category)return void alert(chrome.i18n.getMessage("youMustSelectACategory"));if("Music"===(null===(o=null===(t=null===(e=this.contentContainer().videoInfo)||void 0===e?void 0:e.microformat)||void 0===t?void 0:t.playerMicroformatRenderer)||void 0===o?void 0:o.category))for(const e of n)if("sponsor"===e.category){if(!confirm(chrome.i18n.getMessage("nonMusicCategoryOnMusic")))return;break}this.props.callback(),this.cancel()}}t.default=c},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(1),i=o(3),s=o(0),r=o(4),a=o(2),c=o(5),l=o(32),u=new a.default;class d extends n.Component{constructor(e){super(e),this.fullVideoWarningShown=!1,this.categoryOptionRef=n.createRef(),this.actionTypeOptionRef=n.createRef(),this.idSuffix=this.props.idSuffix,this.previousSkipType=r.CategoryActionType.Skippable,this.state={editing:!1,sponsorTimeEdits:[null,null],selectedCategory:"chooseACategory"}}componentDidMount(){document.getElementById("sponsorTimesContainer"+this.idSuffix).addEventListener("keydown",(function(e){e.stopPropagation()})),document.getElementById("sponsorTimesContainer"+this.idSuffix).addEventListener("wheel",(function(e){e.preventDefault()}),{passive:!1}),this.configUpdateListener||(this.configUpdateListener=()=>this.configUpdate(),s.default.configListeners.push(this.configUpdate.bind(this))),this.checkToShowFullVideoWarning()}componentWillUnmount(){this.configUpdateListener&&s.default.configListeners.splice(s.default.configListeners.indexOf(this.configUpdate.bind(this)),1)}render(){var e,t;this.checkToShowFullVideoWarning();const o={textAlign:"center"};0!=this.props.index&&(o.marginTop="15px");const s=e=>{e&&(e.style.setProperty("color","black","important"),e.style.setProperty("text-shadow","none","important"))};let a;const l={},d=this.props.contentContainer().sponsorTimesSubmitting[this.props.index],p=d.segment;return(null==d?void 0:d.actionType)===r.ActionType.Full&&(l.display="none"),a=this.state.editing?n.createElement("div",{id:"sponsorTimesContainer"+this.idSuffix,style:l,className:"sponsorTimeDisplay"},n.createElement("span",{id:"nowButton0"+this.idSuffix,className:"sponsorNowButton",onClick:()=>this.setTimeToNow(0)},chrome.i18n.getMessage("bracketNow")),n.createElement("input",{id:"submittingTime0"+this.idSuffix,className:"sponsorTimeEdit sponsorTimeEditInput",ref:s,type:"text",value:this.state.sponsorTimeEdits[0],onChange:e=>{this.handleOnChange(0,e,d,e.target.value)},onWheel:e=>{this.changeTimesWhenScrolling(0,e,d)}}),c.getCategoryActionType(d.category)===r.CategoryActionType.Skippable?n.createElement("span",null,n.createElement("span",null," "+chrome.i18n.getMessage("to")+" "),n.createElement("input",{id:"submittingTime1"+this.idSuffix,className:"sponsorTimeEdit sponsorTimeEditInput",ref:s,type:"text",value:this.state.sponsorTimeEdits[1],onChange:e=>{this.handleOnChange(1,e,d,e.target.value)},onWheel:e=>{this.changeTimesWhenScrolling(1,e,d)}}),n.createElement("span",{id:"nowButton1"+this.idSuffix,className:"sponsorNowButton",onClick:()=>this.setTimeToNow(1)},chrome.i18n.getMessage("bracketNow")),n.createElement("span",{id:"endButton"+this.idSuffix,className:"sponsorNowButton",onClick:()=>this.setTimeToEnd()},chrome.i18n.getMessage("bracketEnd"))):""):n.createElement("div",{id:"sponsorTimesContainer"+this.idSuffix,style:l,className:"sponsorTimeDisplay",onClick:this.toggleEditTime.bind(this)},u.getFormattedTime(p[0],!0)+(isNaN(p[1])||c.getCategoryActionType(d.category)!==r.CategoryActionType.Skippable?"":" "+chrome.i18n.getMessage("to")+" "+u.getFormattedTime(p[1],!0))),n.createElement("div",{style:o},a,n.createElement("div",{style:{position:"relative"}},n.createElement("select",{id:"sponsorTimeCategories"+this.idSuffix,className:"sponsorTimeEditSelector sponsorTimeCategories",defaultValue:d.category,ref:this.categoryOptionRef,onChange:this.categorySelectionChange.bind(this)},this.getCategoryOptions()),n.createElement("a",{href:i.wikiLinks[d.category]||"https://wiki.sponsor.ajay.app/index.php/Segment_Categories",target:"_blank",rel:"noreferrer"},n.createElement("img",{id:"sponsorTimeCategoriesHelpButton"+this.idSuffix,className:"helpButton",src:chrome.extension.getURL("icons/help.svg"),title:chrome.i18n.getMessage("categoryGuidelines")}))),i.categorySupport[d.category]&&((null===(e=i.categorySupport[d.category])||void 0===e?void 0:e.length)>1||"skip"!==(null===(t=i.categorySupport[d.category])||void 0===t?void 0:t[0]))?n.createElement("div",{style:{position:"relative"}},n.createElement("select",{id:"sponsorTimeActionTypes"+this.idSuffix,className:"sponsorTimeEditSelector sponsorTimeActionTypes",defaultValue:d.actionType,ref:this.actionTypeOptionRef,onChange:()=>this.saveEditTimes()},this.getActionTypeOptions(d))):"",n.createElement("br",null),n.createElement("span",{id:"sponsorTimeDeleteButton"+this.idSuffix,className:"sponsorTimeEditButton",onClick:this.deleteTime.bind(this)},chrome.i18n.getMessage("delete")),isNaN(p[1])||c.getCategoryActionType(d.category)!==r.CategoryActionType.Skippable?"":n.createElement("span",{id:"sponsorTimePreviewButton"+this.idSuffix,className:"sponsorTimeEditButton",onClick:e=>this.previewTime(e.ctrlKey,e.shiftKey)},chrome.i18n.getMessage("preview")),isNaN(p[1])?"":n.createElement("span",{id:"sponsorTimeInspectButton"+this.idSuffix,className:"sponsorTimeEditButton",onClick:this.inspectTime.bind(this)},chrome.i18n.getMessage("inspect")),isNaN(p[1])?"":n.createElement("span",{id:"sponsorTimeEditButton"+this.idSuffix,className:"sponsorTimeEditButton",onClick:this.toggleEditTime.bind(this)},this.state.editing?chrome.i18n.getMessage("save"):chrome.i18n.getMessage("edit")))}handleOnChange(e,t,o,n){const i=this.state.sponsorTimeEdits,s=u.getFormattedTimeToSeconds(i[e]),a=u.getFormattedTimeToSeconds(n),l=Math.abs(s-a);0<l&&l<.5&&this.showScrollToEditToolTip(),i[e]=n,0===e&&c.getCategoryActionType(o.category)===r.CategoryActionType.POI&&(i[1]=n),this.setState({sponsorTimeEdits:i}),this.saveEditTimes()}changeTimesWhenScrolling(e,t,o){let n=0;n=t.shiftKey?t.ctrlKey?1:.001:t.ctrlKey?.1:.01;const i=this.state.sponsorTimeEdits;let s=u.getFormattedTimeToSeconds(this.state.sponsorTimeEdits[e]);null!==s&&0!=t.deltaY&&(t.deltaY<0?s+=n:s>=n?s-=n:s=0,i[e]=u.getFormattedTime(s,!0),c.getCategoryActionType(o.category)===r.CategoryActionType.POI&&(i[1]=i[0]),this.setState({sponsorTimeEdits:i}),this.saveEditTimes())}showScrollToEditToolTip(){s.default.config.scrollToEditTimeUpdate||null!==document.getElementById("sponsorRectangleTooltipsponsorTimesContainer"+this.idSuffix)||this.showToolTip(chrome.i18n.getMessage("SponsorTimeEditScrollNewFeature"),()=>{s.default.config.scrollToEditTimeUpdate=!0})}showToolTip(e,t){const o=document.getElementById("sponsorTimesContainer"+this.idSuffix);return!!o&&(new l.RectangleTooltip({text:e,referenceNode:o.parentElement,prependElement:o,timeout:15,bottomOffset:"0px",leftOffset:"-318px",backgroundColor:"rgba(28, 28, 28, 1.0)",htmlId:"sponsorTimesContainer"+this.idSuffix,buttonFunction:t,fontSize:"14px",maxHeight:"200px"}),!0)}checkToShowFullVideoWarning(){const e=this.props.contentContainer().sponsorTimesSubmitting[this.props.index];(e.segment[1]-e.segment[0])/this.props.contentContainer().v.duration>.6&&!this.fullVideoWarningShown&&("sponsor"===e.category||"selfpromo"===e.category||"chooseACategory"===e.category)&&this.showToolTip(chrome.i18n.getMessage("fullVideoTooltipWarning"))&&(this.fullVideoWarningShown=!0)}getCategoryOptions(){var e;const t=[n.createElement("option",{value:"chooseACategory",key:"chooseACategory"},chrome.i18n.getMessage("chooseACategory"))];for(const o of null!==(e=this.props.categoryList)&&void 0!==e?e:i.categoryList)t.push(n.createElement("option",{value:o,key:o,className:this.getCategoryLockedClass(o)},chrome.i18n.getMessage("category_"+o)));return t}getCategoryLockedClass(e){return this.props.contentContainer().lockedCategories.includes(e)?"sponsorBlockLockedColor":""}categorySelectionChange(e){if("chooseACategory"!==e.target.value&&!s.default.config.categorySelections.some(t=>t.name===e.target.value)){const t=e.target.value;return e.target.value="chooseACategory",void(confirm(chrome.i18n.getMessage("enableThisCategoryFirst").replace("{0}",chrome.i18n.getMessage("category_"+t)))&&chrome.runtime.sendMessage({message:"openConfig",hash:t+"OptionsName"}))}c.getCategoryActionType(e.target.value)===r.CategoryActionType.POI?(this.previousSkipType===r.CategoryActionType.Skippable&&(this.timeBeforeChangingToPOI=u.getFormattedTimeToSeconds(this.state.sponsorTimeEdits[1])),this.setTimeTo(1,null),this.props.contentContainer().updateEditButtonsOnPlayer(),this.props.contentContainer().sponsorTimesSubmitting.some((t,o)=>t.category===e.target.value&&o!==this.props.index)&&alert(chrome.i18n.getMessage("poiOnlyOneSegment"))):c.getCategoryActionType(e.target.value)===r.CategoryActionType.Skippable&&this.previousSkipType===r.CategoryActionType.POI&&this.setTimeTo(1,this.timeBeforeChangingToPOI),this.previousSkipType=c.getCategoryActionType(e.target.value),this.saveEditTimes()}getActionTypeOptions(e){const t=[];for(const o of i.categorySupport[e.category])t.push(n.createElement("option",{value:o,key:o},chrome.i18n.getMessage(o)));return t}setTimeToNow(e){this.setTimeTo(e,this.props.contentContainer().getRealCurrentTime())}setTimeToEnd(){this.setTimeTo(1,this.props.contentContainer().v.duration)}setTimeTo(e,t){const o=this.props.contentContainer().sponsorTimesSubmitting[this.props.index];null===t&&(t=o.segment[0]),o.segment[e]=t,c.getCategoryActionType(o.category)===r.CategoryActionType.POI&&(o.segment[1]=t),this.setState({sponsorTimeEdits:this.getFormattedSponsorTimesEdits(o)},this.saveEditTimes)}toggleEditTime(){if(this.state.editing)this.setState({editing:!1}),this.saveEditTimes();else{const e=this.props.contentContainer().sponsorTimesSubmitting[this.props.index];this.setState({editing:!0,sponsorTimeEdits:this.getFormattedSponsorTimesEdits(e)})}}getFormattedSponsorTimesEdits(e){return[u.getFormattedTime(e.segment[0],!0),u.getFormattedTime(e.segment[1],!0)]}saveEditTimes(){var e,t,o,n,a;const c=this.props.contentContainer().sponsorTimesSubmitting;if(this.state.editing){const e=u.getFormattedTimeToSeconds(this.state.sponsorTimeEdits[0]),t=u.getFormattedTimeToSeconds(this.state.sponsorTimeEdits[1]);null!==e&&null!==t&&(c[this.props.index].segment=[e,t])}const l=this.categoryOptionRef.current.value;c[this.props.index].category=l;const d=null===(t=null===(e=this.actionTypeOptionRef)||void 0===e?void 0:e.current)||void 0===t?void 0:t.value,p=d&&(null===(o=i.categorySupport[l])||void 0===o?void 0:o.includes(d))?d:null!==(a=null===(n=i.categorySupport[l])||void 0===n?void 0:n[0])&&void 0!==a?a:r.ActionType.Skip;c[this.props.index].actionType=p,s.default.config.segmentTimes.set(this.props.contentContainer().sponsorVideoID,c),this.props.contentContainer().updatePreviewBar(),c[this.props.index].actionType!==r.ActionType.Full||0===c[this.props.index].segment[0]&&0===c[this.props.index].segment[1]||(this.setTimeTo(0,0),this.setTimeTo(1,0))}previewTime(e=!1,t=!1){const o=this.props.contentContainer().sponsorTimesSubmitting[this.props.index].segment[0];let n=2;e&&(n=.5),t&&(n=.25),this.props.contentContainer().previewTime(o-n*this.props.contentContainer().v.playbackRate)}inspectTime(){const e=this.props.contentContainer().sponsorTimesSubmitting[this.props.index].segment[0];this.props.contentContainer().previewTime(e+1e-4,!1)}deleteTime(){const e=this.props.contentContainer().sponsorTimesSubmitting,t=this.props.index,o=e[t].segment.length<2;e.splice(t,1),s.default.config.segmentTimes.set(this.props.contentContainer().sponsorVideoID,e),this.props.contentContainer().updatePreviewBar(),0==e.length?this.props.submissionNotice.cancel():this.props.submissionNotice.forceUpdate(),(0===e.length||o)&&this.props.contentContainer().updateEditButtonsOnPlayer()}configUpdate(){this.forceUpdate()}}t.default=d},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleTooltip=void 0;const n=o(1),i=o(6);t.RectangleTooltip=class{constructor(e){var t,o,s,r,a,c,l;null!==(t=e.bottomOffset)&&void 0!==t||(e.bottomOffset="0px"),null!==(o=e.leftOffset)&&void 0!==o||(e.leftOffset="0px"),null!==(s=e.maxHeight)&&void 0!==s||(e.maxHeight="100px"),null!==(r=e.maxWidth)&&void 0!==r||(e.maxWidth="300px"),null!==(a=e.backgroundColor)&&void 0!==a||(e.backgroundColor="rgba(28, 28, 28, 0.7)"),this.text=e.text,null!==(c=e.fontSize)&&void 0!==c||(e.fontSize="10px"),this.container=document.createElement("div"),null!==(l=e.htmlId)&&void 0!==l||(e.htmlId=e.text),this.container.id="sponsorRectangleTooltip"+e.htmlId,this.container.style.display="relative",e.prependElement?e.referenceNode.insertBefore(this.container,e.prependElement):e.referenceNode.appendChild(this.container),e.timeout&&(this.timer=setTimeout(()=>this.close(),1e3*e.timeout)),i.render(n.createElement("div",{style:{bottom:e.bottomOffset,left:e.leftOffset,maxHeight:e.maxHeight,maxWidth:e.maxWidth,backgroundColor:e.backgroundColor,fontSize:e.fontSize},className:"sponsorBlockRectangleTooltip"},n.createElement("div",null,n.createElement("img",{className:"sponsorSkipLogo sponsorSkipObject",src:chrome.extension.getURL("icons/IconSponsorBlocker256px.png")}),n.createElement("span",{className:"sponsorSkipObject"},this.text+(e.link?". ":""),e.link?n.createElement("a",{style:{textDecoration:"underline"},target:"_blank",rel:"noopener noreferrer",href:e.link},chrome.i18n.getMessage("LearnMore")):null)),n.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton",style:{float:"right"},onClick:()=>{e.buttonFunction&&e.buttonFunction(),this.close()}},chrome.i18n.getMessage("GotIt"))),this.container)}close(){i.unmountComponentAtNode(this.container),this.container.remove(),this.timer&&clearTimeout(this.timer)}}},function(e,t,o){"use strict";var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.openWarningChat=t.openChat=void 0;const i=o(0),s=new(o(2).default);function r(e){const t=document.createElement("div");t.classList.add("sbChatNotice"),t.style.zIndex="2000";const o=document.createElement("iframe");o.src="https://chat.sponsor.ajay.app/#"+s.objectToURI("",e,!1),t.appendChild(o);const n=document.createElement("img");n.classList.add("sbChatClose"),n.src=chrome.extension.getURL("icons/close.png"),n.addEventListener("click",()=>{t.remove(),n.remove()}),t.appendChild(n),s.findReferenceNode().prepend(t)}t.openChat=r,t.openWarningChat=function(e){return n(this,void 0,void 0,(function*(){const t=e.match(/Warning reason: '(.+)'/);alert(chrome.i18n.getMessage("warningChatInfo")+`\n\n${t?` Warning reason: ${t[1]}`:""}`);const o=yield s.asyncRequestToServer("GET","/api/getUsername?userID="+i.default.config.userID),n=o.ok?JSON.parse(o.responseText).userName:"",a=yield s.getHash(i.default.config.userID);r({displayName:`${n||""}${n!==a?` | ${a}`:""}`,composerInitialValue:` Warning reason: ${t[1]}`,customDescription:chrome.i18n.getMessage("warningChatInfo")})}))}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SkipButtonControlBar=void 0;const n=o(0),i=o(5),s=o(2),r=o(8);new s.default;t.SkipButtonControlBar=class{constructor(e){this.showKeybindHint=!0,this.enabled=!1,this.duration=0,this.left=0,this.swipeStart=0,this.skip=e.skip,this.onMobileYouTube=e.onMobileYouTube,this.container=document.createElement("div"),this.container.classList.add("skipButtonControlBarContainer"),this.container.classList.add("hidden"),this.onMobileYouTube&&this.container.classList.add("mobile"),this.skipIcon=document.createElement("img"),this.skipIcon.src=chrome.runtime.getURL("icons/skipIcon.svg"),this.skipIcon.classList.add("ytp-button"),this.skipIcon.id="sbSkipIconControlBarImage",this.textContainer=document.createElement("div"),this.container.appendChild(this.skipIcon),this.container.appendChild(this.textContainer),this.container.addEventListener("click",()=>this.toggleSkip()),this.container.addEventListener("mouseenter",()=>this.stopTimer()),this.container.addEventListener("mouseleave",()=>this.startTimer()),this.onMobileYouTube&&(this.container.addEventListener("touchstart",e=>this.handleTouchStart(e)),this.container.addEventListener("touchmove",e=>this.handleTouchMove(e)),this.container.addEventListener("touchend",()=>this.handleTouchEnd()))}getElement(){return this.container}attachToPage(){const e=this.getMountingContainer();if(this.chapterText=document.querySelector(".ytp-chapter-container"),e&&!e.contains(this.container))if(this.onMobileYouTube?e.appendChild(this.container):e.insertBefore(this.container,this.chapterText),this.onMobileYouTube){const{hide:t,show:o}=r.AnimationUtils.setupCustomHideAnimation(this.skipIcon,e,!1,!1);this.hideButton=t,this.showButton=o}else r.AnimationUtils.setupAutoHideAnimation(this.skipIcon,e,!1,!1)}getMountingContainer(){return this.onMobileYouTube?document.getElementById("player-container-id"):document.querySelector(".ytp-left-controls")}enable(e,t){var o,n;t&&(this.duration=t),this.segment=e,this.enabled=!0,this.refreshText(),null===(n=null===(o=this.textContainer)||void 0===o?void 0:o.classList)||void 0===n||n.remove("hidden"),r.AnimationUtils.disableAutoHideAnimation(this.skipIcon),this.startTimer()}refreshText(){var e,t;this.segment&&(null===(t=null===(e=this.chapterText)||void 0===e?void 0:e.classList)||void 0===t||t.add("hidden"),this.container.classList.remove("hidden"),this.textContainer.innerText=this.getTitle(),this.skipIcon.setAttribute("title",this.getTitle()))}setShowKeybindHint(e){this.showKeybindHint=e,this.refreshText()}stopTimer(){this.timeout&&clearTimeout(this.timeout)}startTimer(){this.stopTimer(),this.timeout=setTimeout(()=>this.disableText(),1e3*Math.max(n.default.config.skipNoticeDuration,this.duration))}disable(){var e,t,o,n,i,s;this.container.classList.add("hidden"),null===(t=null===(e=this.textContainer)||void 0===e?void 0:e.classList)||void 0===t||t.remove("hidden"),null===(n=null===(o=this.chapterText)||void 0===o?void 0:o.classList)||void 0===n||n.remove("hidden"),null===(s=null===(i=this.getChapterPrefix())||void 0===i?void 0:i.classList)||void 0===s||s.remove("hidden"),this.enabled=!1}toggleSkip(){this.skip(this.segment),this.disableText()}disableText(){var e,t,o,i,s,a;n.default.config.hideVideoPlayerControls||n.default.config.hideSkipButtonPlayerControls?this.disable():(this.container.classList.add("textDisabled"),null===(t=null===(e=this.textContainer)||void 0===e?void 0:e.classList)||void 0===t||t.add("hidden"),null===(i=null===(o=this.chapterText)||void 0===o?void 0:o.classList)||void 0===i||i.remove("hidden"),null===(a=null===(s=this.getChapterPrefix())||void 0===s?void 0:s.classList)||void 0===a||a.add("hidden"),r.AnimationUtils.enableAutoHideAnimation(this.skipIcon),this.onMobileYouTube&&this.hideButton())}updateMobileControls(){var e;const t=document.getElementById("player-control-overlay");t&&this.enabled&&((null===(e=null==t?void 0:t.classList)||void 0===e?void 0:e.contains("pointer-events-off"))?this.hideButton():this.showButton())}getTitle(){return i.getSkippingText([this.segment],!1)+(this.showKeybindHint?" ("+n.default.config.skipKeybind+")":"")}getChapterPrefix(){return document.querySelector(".ytp-chapter-title-prefix")}handleTouchStart(e){this.swipeStart=e.touches[0].clientX}handleTouchMove(e){const t=this.swipeStart-e.touches[0].clientX;this.left=Math.min(-t,0),this.updateLeftStyle()}handleTouchEnd(){this.left<-this.container.offsetWidth/2&&(this.disableText(),this.skipIcon.style.display="none",setTimeout(()=>this.skipIcon.style.removeProperty("display"),200)),this.left=0,this.updateLeftStyle()}updateLeftStyle(){this.container.style.left=this.left+"px"}}},function(e,t,o){"use strict";function n(e){var t,o,n;if(!e)return 0;const i=/(?:(\d{1,3})h)?(?:(\d{1,2})m)?(\d+)s?/.exec(e);if(i){return 3600*parseInt(null!==(t=i[1])&&void 0!==t?t:"0",10)+60*parseInt(null!==(o=i[2])&&void 0!==o?o:"0",10)+parseInt(null!==(n=i[3])&&void 0!==n?n:"0",10)}return/\d+/.test(e)?parseInt(e,10):void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.urlTimeToSeconds=t.getStartTimeFromUrl=void 0,t.getStartTimeFromUrl=function(e){const t=new URLSearchParams(e);return n((null==t?void 0:t.get("t"))||(null==t?void 0:t.get("time_continue")))},t.urlTimeToSeconds=n},function(e,t,o){"use strict";var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CategoryPill=void 0;const i=o(1),s=o(6),r=o(37),a=o(0),c=o(7),l=o(38);t.CategoryPill=class{constructor(){this.ref=i.createRef()}attachToPage(e,t,o){var a;return n(this,void 0,void 0,(function*(){const n=yield c.GenericUtils.wait(()=>document.querySelector("#title h1, .ytd-video-primary-info-renderer.title, .slim-video-information-title, #player-container + .h-box > h1"));n&&!n.contains(this.container)&&(this.container=document.createElement("span"),this.container.id="categoryPill",this.container.style.display="relative",n.prepend(this.container),n.style.display="flex",this.ref.current&&(this.unsavedState=this.ref.current.state),s.render(i.createElement(r.default,{ref:this.ref,vote:o}),this.container),this.unsavedState&&(null===(a=this.ref.current)||void 0===a||a.setState(this.unsavedState),this.unsavedState=null),e&&(this.mutationObserver&&this.mutationObserver.disconnect(),this.mutationObserver=new MutationObserver(()=>this.attachToPage(e,t,o)),this.mutationObserver.observe(n,{childList:!0,subtree:!0})))}))}close(){s.unmountComponentAtNode(this.container),this.container.remove()}setVisibility(e){var t,o;const n={show:e,open:!!e&&(null===(t=this.ref.current)||void 0===t?void 0:t.state.open)};this.ref.current?null===(o=this.ref.current)||void 0===o||o.setState(n):this.unsavedState=n}setSegment(e){var t,o,i;return n(this,void 0,void 0,(function*(){if((null===(o=null===(t=this.ref.current)||void 0===t?void 0:t.state)||void 0===o?void 0:o.segment)!==e){const t={segment:e,show:!0,open:!1};if(this.ref.current?null===(i=this.ref.current)||void 0===i||i.setState(t):this.unsavedState=t,!a.default.config.categoryPillUpdate){a.default.config.categoryPillUpdate=!0;const e=yield c.GenericUtils.wait(()=>document.querySelector("#info.ytd-watch-flexy"));e&&new l.Tooltip({text:chrome.i18n.getMessage("categoryPillNewFeature"),link:"https://blog.ajay.app/full-video-sponsorblock",referenceNode:e,prependElement:e.firstChild,bottomOffset:"-10px",opacity:.95,timeout:5e4})}}}))}}},function(e,t,o){"use strict";var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=o(1),s=o(0),r=o(16),a=o(17),c=o(10),l=o(8),u=o(7);class d extends i.Component{constructor(e){super(e),this.state={segment:null,show:!1,open:!1}}render(){var e,t,o;const n={backgroundColor:this.getColor(),display:this.state.show?"flex":"none",color:"sponsor"===(null===(e=this.state.segment)||void 0===e?void 0:e.category)||"exclusive_access"===(null===(t=this.state.segment)||void 0===t?void 0:t.category)?"white":"black"};return i.createElement("span",{style:n,className:"sponsorBlockCategoryPill",title:this.getTitleText(),onClick:e=>this.toggleOpen(e)},i.createElement("span",{className:"sponsorBlockCategoryPillTitleSection"},i.createElement("img",{className:"sponsorSkipLogo sponsorSkipObject",src:chrome.extension.getURL("icons/IconSponsorBlocker256px.png")}),i.createElement("span",{className:"sponsorBlockCategoryPillTitle"},chrome.i18n.getMessage("category_"+(null===(o=this.state.segment)||void 0===o?void 0:o.category)))),this.state.open&&i.createElement(i.Fragment,null,i.createElement("div",{id:"sponsorTimesDownvoteButtonsContainerUpvoteCategoryPill",className:"voteButton",style:{marginLeft:"5px"},title:chrome.i18n.getMessage("upvoteButtonInfo"),onClick:e=>this.vote(e,1)},i.createElement(r.default,{fill:s.default.config.colorPalette.white})),i.createElement("div",{id:"sponsorTimesDownvoteButtonsContainerDownvoteCategoryPill",className:"voteButton",title:chrome.i18n.getMessage("reportButtonInfo"),onClick:e=>this.vote(e,0)},i.createElement(a.default,{fill:c.downvoteButtonColor(null,null,c.SkipNoticeAction.Downvote)}))),i.createElement("img",{src:chrome.extension.getURL("icons/close.png"),className:"categoryPillClose",onClick:()=>this.setState({show:!1})}))}toggleOpen(e){e.stopPropagation(),this.state.show&&this.setState({open:!this.state.open})}vote(e,t){return n(this,void 0,void 0,(function*(){if(e.stopPropagation(),this.state.segment){const o=l.AnimationUtils.applyLoadingAnimation(e.currentTarget,.3),n=yield this.props.vote(t,this.state.segment.UUID);yield o(),1==n.successType||-1==n.successType&&429==n.statusCode?this.setState({open:!1,show:1===t}):403!==n.statusCode&&alert(u.GenericUtils.getErrorMessage(n.statusCode,n.responseText))}}))}getColor(){var e,t;const o=s.default.config.barTypes["preview-"+(null===(e=this.state.segment)||void 0===e?void 0:e.category)]||s.default.config.barTypes[null===(t=this.state.segment)||void 0===t?void 0:t.category];return null==o?void 0:o.color}getTitleText(){var e;const t=chrome.i18n.getMessage(`category_${null===(e=this.state.segment)||void 0===e?void 0:e.category}_pill`);return(t?t+". ":"")+chrome.i18n.getMessage("categoryPillTitleText")}}t.default=d},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tooltip=void 0;const n=o(1),i=o(6);t.Tooltip=class{constructor(e){var t,o;null!==(t=e.bottomOffset)&&void 0!==t||(e.bottomOffset="70px"),null!==(o=e.opacity)&&void 0!==o||(e.opacity=.7),this.text=e.text,this.container=document.createElement("div"),this.container.id="sponsorTooltip"+e.text,this.container.style.position="relative",e.prependElement?e.referenceNode.insertBefore(this.container,e.prependElement):e.referenceNode.appendChild(this.container),e.timeout&&(this.timer=setTimeout(()=>this.close(),1e3*e.timeout));const s=`rgba(28, 28, 28, ${e.opacity})`;i.render(n.createElement("div",{style:{bottom:e.bottomOffset,backgroundColor:s},className:"sponsorBlockTooltip"},n.createElement("div",null,n.createElement("img",{className:"sponsorSkipLogo sponsorSkipObject",src:chrome.extension.getURL("icons/IconSponsorBlocker256px.png")}),n.createElement("span",{className:"sponsorSkipObject"},this.text+(e.link?". ":""),e.link?n.createElement("a",{style:{textDecoration:"underline"},target:"_blank",rel:"noopener noreferrer",href:e.link},chrome.i18n.getMessage("LearnMore")):null)),n.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton",style:{float:"right"},onClick:()=>this.close()},chrome.i18n.getMessage("GotIt"))),this.container)}close(){i.unmountComponentAtNode(this.container),this.container.remove(),this.timer&&clearTimeout(this.timer)}}}]);